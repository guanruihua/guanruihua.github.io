"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[2266],{2266:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var o=n(6540),s=n(7317),r=n(8308),a=n(1742),c=(e,t,n)=>new Promise((o,s)=>{var r=e=>{try{c(n.next(e))}catch(e){s(e)}},a=e=>{try{c(n.throw(e))}catch(e){s(e)}},c=e=>e.done?o(e.value):Promise.resolve(e.value).then(r,a);c((n=n.apply(e,t)).next())});function u(e){const{name:t}=e,[n,u]=(0,s.xI)({value:""}),{sendMessage:l,messages:i=[]}=function(e,t){const[n,a]=(0,o.useState)(!1),[u,l]=(0,s.xI)({messages:[]},t),{messages:i=[]}=u,m=(0,o.useRef)(null),d={messages:i,onMessage(e){return c(this,null,function*(){var t,n;const o=(0,r.qg)(yield null==(n=null==(t=e.data)?void 0:t.text)?void 0:n.call(t),void 0);if(console.log(o,this.messages),o&&o.id){const e=(null==this?void 0:this.messages)||[];if(e.map(e=>e.id).includes(o.id))return;e.push(o),l({messages:e}),this.messages=e}})}};return(0,o.useEffect)(()=>{const t=new WebSocket(e);return t.onopen=()=>{a(!0),console.log("WebSocket connected")},t.onclose=()=>{a(!1),console.log("WebSocket disconnected")},t.onmessage=d.onMessage,t.onerror=e=>{console.error("WebSocket error:",e)},m.current=t,()=>{t.close()}},[e]),{isReady:n,messages:i,sendMessage:e=>!(!m.current||!n||(m.current.send(e),0))}}("ws://localhost:2410","/tool/webSocket/cache|"+t);return o.createElement("div",{className:"webSocket-user"},o.createElement("h3",null,o.createElement("span",null,t)),o.createElement("div",{className:"webSocket-user-message-box"},null==i?void 0:i.map((e,t)=>{const{type:n,name:s,content:r}=e;return o.createElement("div",{key:t},s,"-",r)})),o.createElement("div",{className:"webSocket-user-content"},o.createElement(a.pd,{value:n.value,onChange:e=>{const t=e.target.value;u({value:t})}}),o.createElement(a.$n,{onClick:()=>(()=>{const e={id:Date.now(),type:"message",name:t,content:n.value||""};l((0,r.dI)(e))})()},"Send")))}function l(){return o.createElement("div",{className:"tool-webSocket"},o.createElement("div",{className:"tool-webSocket-box"},o.createElement(u,{name:"User1"}),o.createElement(u,{name:"User2 "})))}},7317:(e,t,n)=>{n.d(t,{xI:()=>i});var o=n(6540);function s(e){return null==e||e!=e}function r(e){try{if("object"==typeof(t=e)&&!s(t)&&/Iterator\]$/.test(t.toString()))return"Iterator";const n=Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1];return"Number"===n&&isNaN(e)?"NaN":n}catch(e){return"Undefined"}var t}function a(e){return"string"==typeof e}const c=e=>"number"==typeof e&&"Number"===r(e);function u(e){return!s(e)&&(function(e){return Array.isArray(e)}(e)&&e.length>0)}const l="undefined"!=typeof window;function i(e={},t,n=localStorage){const[s,r]=(0,o.useState)(e),l=e=>{if(r(e),t)try{n.setItem(t,JSON.stringify(e))}catch(e){return void console.warn(e)}};return(0,o.useEffect)(()=>{if(t)try{const e=n.getItem(t);if(!e||"{}"===e)return;l(JSON.parse(e))}catch(e){return}},[t,n]),[s,(e,t=!1)=>{const n="function"==typeof e?e(s):e;l(t?n:{...s,...n})},t=>{if(u(t)){const n={...s};return t.forEach(t=>{(a(t)||c(t))&&(n[t]=e[t])}),void l(n)}l(e)}]}l&&window?.navigator?.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent)}}]);