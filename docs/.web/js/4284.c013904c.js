"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[4284],{6547:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var l=n(6540),r=n(1742),a=n(5643),c=n.n(a),o=(e,t,n)=>new Promise((l,r)=>{var a=e=>{try{o(n.next(e))}catch(e){r(e)}},c=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=e=>e.done?l(e.value):Promise.resolve(e.value).then(a,c);o((n=n.apply(e,t)).next())});const i=e=>new Promise(t=>{const n=e.getContext("2d");if(!n)return void t("");n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high";const l=Math.min(e.width,e.height),r=document.createElement("canvas");r.width=l,r.height=l;const a=r.getContext("2d",{willReadFrequently:!0});a?(a.clearRect(0,0,l,l),a.beginPath(),a.arc(l/2,l/2,l/2,0,2*Math.PI),a.closePath(),a.clip(),a.drawImage(e,0,0,l,l),t(r.toDataURL("image/png"))):t("")});var u=n(8308),s=(e,t,n)=>new Promise((l,r)=>{var a=e=>{try{o(n.next(e))}catch(e){r(e)}},c=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=e=>e.done?l(e.value):Promise.resolve(e.value).then(a,c);o((n=n.apply(e,t)).next())});const m=()=>{const[e,t]=l.useState(null),n=l.useRef(null),r=l.useRef(null),a=l.useRef(null),[m,p]=l.useState({square:"",circle:""}),d=()=>s(null,null,function*(){if(!r.current)return;const e=new(c())(r.current,{aspectRatio:1,viewMode:1,autoCropArea:.8,responsive:!0,restore:!1,guides:!1,center:!0,highlight:!1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!1});a.current=e}),g=(0,u.sg)(()=>s(null,null,function*(){if(!a.current)return;const e=a.current.getCroppedCanvas({fillColor:"transparent"});p({square:e.toDataURL("image/png"),circle:yield i(e)})}),100);return l.useEffect(()=>{var t;if(r.current)return d(),null==(t=r.current)||t.removeEventListener("crop",g),r.current.addEventListener("crop",g),()=>{var t,n,l;null==(n=null==(t=a.current)?void 0:t.destroy)||n.call(t),null==(l=r.current)||l.removeEventListener("crop",g),e&&URL.revokeObjectURL(e)}},[r.current]),{uploadFile:e,uploadRef:n,container:r,previewImg:m,handleDownload:e=>s(null,null,function*(){if(!a.current)return;if(e&&m[e])return((e,t="temp.png")=>o(null,null,function*(){if(e){const n=document.createElement("a");n.href=e,n.download=t,n.click()}}))(m[e]);((e,t="temp.png")=>{o(null,null,function*(){if(e){const n=document.createElement("a");n.href=yield i(e),n.download=t,n.click()}})})(a.current.getCroppedCanvas({fillColor:"transparent"}))}),handleUpload:()=>{const e=n.current;e&&(null==e||e.click(),e.onchange=e=>{var n,l,r;const c=(null==(n=e.target)?void 0:n.files[0])||"",o=URL.createObjectURL(c);null==(r=null==(l=a.current)?void 0:l.destroy)||r.call(l),t(o);const i=setTimeout(()=>{d(),clearTimeout(i)},100)})}}},p=n.p+".web/img/tmp.jpg",d={"--cropper-bg":"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC')"};function g(){const e=m();return l.createElement(r.i,{className:"tool-img-clipper",style:d},l.createElement("div",{className:"tool-img-clipper-container"},l.createElement("img",{ref:e.container,src:e.uploadFile||p})),l.createElement(r.so,{column:!0,className:"tool-img-clipper-control"},l.createElement(r.so,null,l.createElement(r.$n,{style:{width:270},onClick:e.handleUpload},"Upload Image")),l.createElement(r.so,{row:!0},e.previewImg.square&&l.createElement(r.so,{column:!0},l.createElement("img",{className:"preview",src:e.previewImg.square}),l.createElement(r.$n,{onClick:()=>e.handleDownload("square")},"Download")),e.previewImg.circle&&l.createElement(r.so,{column:!0},l.createElement("img",{className:"preview",src:e.previewImg.circle}),l.createElement(r.$n,{onClick:()=>e.handleDownload("circle")},"Download")))),l.createElement("input",{ref:e.uploadRef,type:"file",accept:"image/*",style:{display:"none"}}))}}}]);