"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[2094],{3619:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var o=n(5296),i=n(6045);const s=n.p+".web/img/ball_32_32.png",r=n.p+".web/img/paddle_128_32.png",l=n.p+".web/img/brick1_64_32.png",c=n.p+".web/img/brick2_64_32.png",a=n.p+".web/img/brick3_64_32.png";function u(){this.load.image("ball",s),this.load.image("paddle",r),this.load.image("brick1",l),this.load.image("brick2",c),this.load.image("brick3",a)}function d(e,t){t.disableBody(!0,!0);let n=0;0==e.body.velocity.x&&(n=Math.random(),n>=.5?e.setVelocityX(150):e.setVelocityX(-150))}function p(e,t){e.setVelocityY(e.body.velocity.y-5);let n=Math.abs(e.body.velocity.x)+5;e.x<t.x?e.setVelocityX(-n):e.setVelocityX(n)}const y=()=>{let e=null,t=null,n=[],o=null,i=!1,s={opening:null,gameOver:null,playerWon:null};return{key:"game",preload:u,create:function(){var i;const r=this;e=r.physics.add.sprite(400,600,"paddle"),t=r.physics.add.sprite(400,565,"ball"),n=(e=>[e.physics.add.group({key:"brick1",repeat:9,immovable:!0,setXY:{x:80,y:40,stepX:70}}),e.physics.add.group({key:"brick2",repeat:9,immovable:!0,setXY:{x:80,y:90,stepX:70}}),e.physics.add.group({key:"brick3",repeat:9,immovable:!0,setXY:{x:80,y:140,stepX:70}})])(r),o=null==(i=r.input.keyboard)?void 0:i.createCursorKeys(),null==e||e.setCollideWorldBounds(!0),null==t||t.setCollideWorldBounds(!0),null==t||t.setBounce(1,1),r.physics.world.checkCollision.down=!1,n.forEach(e=>{t&&e&&r.physics.add.collider(t,e,d,void 0,r)}),e.setImmovable(!0),r.physics.add.collider(t,e,p,void 0,r),s=(e=>{const t=e.add.text(e.physics.world.bounds.width/2,e.physics.world.bounds.height/2,"Press SPACE to Start",{fontFamily:"Monaco, Courier, monospace",fontSize:"50px"});t.setOrigin(.5);const n=e.add.text(e.physics.world.bounds.width/2,e.physics.world.bounds.height/2,"Game Over",{fontFamily:"Monaco, Courier, monospace",fontSize:"50px",color:"#F60000"});n.setOrigin(.5),n.setVisible(!1);const o=e.add.text(e.physics.world.bounds.width/2,e.physics.world.bounds.height/2,"You won!",{fontFamily:"Monaco, Courier, monospace",fontSize:"50px"});return o.setOrigin(.5),o.setVisible(!1),{opening:t,gameOver:n,playerWon:o}})(r)},update:function(){var r,l,c;(null==e?void 0:e.body)&&t&&o&&(!function(e,t){return!(!(null==e?void 0:e.body)||!(null==t?void 0:t.bounds))&&e.body.y>t.bounds.height}(t,this.physics.world)?!function(e){let t=-1;return e.forEach(e=>{e&&(-1!==t?t+=e.countActive():t=e.countActive())}),0===t}(n)?(e.setVelocityX(0),o.left.isDown?e.setVelocityX(-350):o.right.isDown&&e.setVelocityX(350),i||(t.setX(e.x),o.space.isDown&&(i=!0,t.setVelocityY(-200),null==(c=s.opening)||c.setVisible(!1)))):(null==(l=s.playerWon)||l.setVisible(!0),t.disableBody(!0,!0)):(null==(r=s.gameOver)||r.setVisible(!0),t.disableBody(!0,!0)))}}},h=()=>{let e=null;return{key:"menu",active:!0,create:function(){const t=this;e=t.add.text(400,350,"Start",{fontSize:"32px",color:"#FFFFFF"}).on("pointerover",()=>{null==e||e.setStyle({fill:"#8FB4F8",fontSize:"32px"}),t.sys.canvas.classList.add("pointer")}).on("pointerout",()=>{null==e||e.setStyle({fill:"#FFFFFF",fontSize:"32px"}),t.sys.canvas.classList.remove("pointer")}).setOrigin(.5).setInteractive().on("pointerdown",()=>{this.scene.start("game")})}}},b=()=>{const e=o.useRef(null),{Phaser:t}=(()=>{const[e,t]=o.useState(null);return o.useEffect(()=>{const e="/js/phaser.min.js",n=document.createElement("script");return n.src=e,n.onload=()=>{console.log("Phaser",e,"已加载");const n=window.Phaser;t(n)},document.body.appendChild(n),()=>{document.body.removeChild(n)}},[]),{Phaser:e}})(),[n,s]=(0,i.xI)({});return o.useEffect(()=>{t&&e.current&&((e,t)=>{const n={type:e.AUTO,parent:t,width:800,height:640,scale:{},scene:[h(),y()],physics:{default:"arcade"}},o=new e.Game(n);console.log(o)})(t,e.current)},[t,e.current]),{containerRef:e,state:n,setState:s}};function f(){const e=b(),{state:t,setState:n}=e;return o.createElement("div",{className:"game__brick"},o.createElement("div",{ref:e.containerRef}))}},6045:(e,t,n)=>{n.d(t,{xI:()=>u});var o=n(5296);function i(e){return null==e||e!=e}function s(e){try{if("object"==typeof(t=e)&&!i(t)&&/Iterator\]$/.test(t.toString()))return"Iterator";const n=Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1];return"Number"===n&&isNaN(e)?"NaN":n}catch(e){return"Undefined"}var t}function r(e){return"string"==typeof e}const l=e=>"number"==typeof e&&"Number"===s(e);function c(e){return!i(e)&&(function(e){return Array.isArray(e)}(e)&&e.length>0)}const a="undefined"!=typeof window;function u(e={},t,n=localStorage){const[i,s]=(0,o.useState)(e),a=e=>{if(s(e),t)try{n.setItem(t,JSON.stringify(e))}catch(e){return void console.warn(e)}};return(0,o.useEffect)(()=>{if(t)try{const e=n.getItem(t);if(!e||"{}"===e)return;a(JSON.parse(e))}catch(e){return}},[t,n]),[i,(e,t=!1)=>{const n="function"==typeof e?e(i):e;a(t?n:{...i,...n})},t=>{if(c(t)){const n={...i};return t.forEach(t=>{(r(t)||l(t))&&(n[t]=e[t])}),void a(n)}a(e)}]}a&&window?.navigator?.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent)}}]);