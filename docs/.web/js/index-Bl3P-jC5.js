import{R as C,j as d}from"./index-BSiT3j47.js";import{g as X}from"./index.esm-vp3mBawv.js";import{u as Y}from"./index.esm-DaoR0Iyu.js";const v=250;function L(e,i){let c=null;return function(){c||(c=setTimeout(()=>{e.apply(this,arguments),c=null},i))}}const h=e=>Math.floor(e/10)*10;function N(e){const{id:i,none:c,onDragStart:a,onDragging:f,onDragEnd:p,children:s,...u}=e,t=C.useRef(null),n=C.useRef({id:i,drag:!1,leaveLeft:!1,dragCount:0,offsetX:0,offsetY:0,lastX:-1,lastY:-1}),r=L(l=>{if(l?.preventDefault?.(),l?.stopPropagation?.(),!t.current||!n.current.drag)return;const g=window.document.body.getBoundingClientRect(),S=t.current.getBoundingClientRect(),R=(x,D="x")=>{if(x<0)return 0;if(D==="x"){const m=g.width-S.width;if(x>=m)return m}if(D==="y"){const m=g.height-S.height;if(x>=m)return m}return x},j=R(l.clientX-n.current.offsetX,"x"),E=R(l.clientY-n.current.offsetY,"y");t.current.style.left=j+"px",t.current.style.top=E+"px",f?.(t,n.current,e)},10);function o(){t.current&&(n.current.offsetX=0,n.current.offsetY=0,n.current.drag=!1,n.current.dragCount=n.current.dragCount+1,t.current.style.opacity="none",t.current.style.zIndex="1",t.current.style.opacity="1",t.current.style.border="none",document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",o),p?.(t,n.current,e))}function y(l){if(l?.preventDefault?.(),l?.stopPropagation?.(),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",o),!t.current)return;const g=t.current.getBoundingClientRect();n.current.lastX=Number(t.current.style.left.replace("px",""))||0,n.current.lastY=Number(t.current.style.top.replace("px",""))||0,n.current.offsetX=l.clientX-g.left,n.current.offsetY=l.clientY-g.top,n.current.drag=!0,t.current.style.opacity=".8",t.current.style.zIndex="10000",t.current.style.border="1px solid rgba(255,255,255, 9)",document.addEventListener("mousemove",r),document.addEventListener("mouseup",o),a?.(t,n.current,e)}return d.jsx("div",{className:X("ele",{none:c}),ref:t,onMouseDown:y,...u,children:s})}const b=()=>{const[e,i]=Y({selectId:"",list:[{id:"1",type:"sider"}]}),c=(r,o)=>{},a=r=>e.list?.find(o=>o.id===r),f=r=>a(r)?.type==="sider",p=r=>a(r)?.type==="content",s=()=>((e.list?.length||0)+1).toString();return{state:e,setState:i,updateState:c,find:a,inSider:f,inContent:p,getId:s,to:(r,o)=>{e.list&&(e.list=e.list.map(y=>(y.id===r&&(y.type=o),y)))},create:()=>{const r={id:s(),type:"sider"};e.list?e.list.push(r):e.list=[r]},del:r=>{e.list&&(e.list=e.list.map(o=>(o.id===r&&(o.type="del"),o)))}}};function M(){const e=b(),{state:i,setState:c}=e,a=(s,u)=>{c({selectId:u.id})},f=(s,u)=>{if(!s.current)return;const t=s.current.getBoundingClientRect(),n=document.querySelector(".auxiliary-line.auxiliary-line-x"),r=document.querySelector(".auxiliary-line.auxiliary-line-y");n&&(n.style.top=h(t.top)+"px"),r&&(r.style.left=(t.left>v?h(t.left):v)+"px")},p=(s,u)=>{if(!s.current)return;const t=s.current.getBoundingClientRect(),{id:n}=u;i.list||(i.list=[]),t.left<v?(s.current.style.left="10px",s.current.style.top="10px",e.inContent(n)&&e.del(n)):(s.current.style.left=h(t.left)+"px",s.current.style.top=h(t.top)+"px",e.inSider(n)&&(e.create(),e.to(n,"content"))),c(i)};return d.jsxs("div",{className:"study-drag",children:[d.jsx("div",{className:"sider",children:i.list?.map(({id:s,type:u})=>d.jsx(N,{id:s,onDragStart:a,onDragging:f,onDragEnd:p,none:u==="del",children:s},s))}),d.jsx("div",{className:"content"}),d.jsx("div",{className:"auxiliary-line auxiliary-line-x"}),d.jsx("div",{className:"auxiliary-line auxiliary-line-y"})]})}export{M as default};
