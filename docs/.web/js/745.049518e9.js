"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[745],{1745:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var r=n(5296);var l=(e,t,n)=>new Promise((r,l)=>{var c=e=>{try{a(n.next(e))}catch(e){l(e)}},o=e=>{try{a(n.throw(e))}catch(e){l(e)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(c,o);a((n=n.apply(e,t)).next())});const c=e=>{const{dbName:t="CacheDB",tableName:n="store",callback:c={}}=e||{},o=r.useRef(null),a=()=>l(null,null,function*(){var e;try{const r=yield function(e,t,n=1){return new Promise(r=>{let l;const c=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).open(e,n);c.onsuccess=function(e){l=e.target.result,r(l)},c.onerror=function(e){console.log("数据库打开失败")},c.onupgradeneeded=function(e){var n;l=e.target.result,(n=l.createObjectStore(t,{keyPath:"key"})).createIndex("key","key",{unique:!0}),n.createIndex("value","value",{unique:!1}),n.createIndex("name","name",{unique:!1}),n.createIndex("sort","sort",{unique:!1}),n.createIndex("info","info",{unique:!1})}})}(t,n);r&&(o.current=r,null==(e=null==c?void 0:c.afterInitSuccess)||e.call(c,r))}catch(e){console.error(e)}});return r.useEffect(()=>{a()},[]),{ref:o,getStore(){var e,t;return o.current?null==(t=null==(e=o.current)?void 0:e.transaction)?void 0:t.call(e,[n],"readwrite").objectStore(n):null},getKey:()=>(()=>{let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)})})(),getAll(){return l(this,null,function*(){return new Promise(e=>{var t;try{const n=[],r=null==(t=this.getStore())?void 0:t.openCursor();r&&(r.onsuccess=function(t){const r=t.target.result;r?(n.push(r.value),r.continue()):e(n.sort((e,t)=>((null==e?void 0:e.sort)||1)-((null==t?void 0:t.sort)||1)))})}catch(t){e([])}})})},get(e){return l(this,null,function*(){return new Promise(t=>{const n=this.getStore().get(e)||null;n?(n.onsuccess=function(e){t(e.target.result)},n.onerror=function(e){t(null)}):t(null)})})},del(e){var t;null==(t=this.getStore())||t.delete(e)},add(e){var t;return e.key||(e.key=this.getKey()),e.info||(e.info={}),e.sort||(e.sort=(new Date).getTime()),null==(t=this.getStore())||t.add(e),e},update(e){var t;return null==(t=this.getStore())||t.put(e),e}}};var o=n(7113),a=n(1814),i=n(4777),u=(e,t,n)=>new Promise((r,l)=>{var c=e=>{try{a(n.next(e))}catch(e){l(e)}},o=e=>{try{a(n.throw(e))}catch(e){l(e)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(c,o);a((n=n.apply(e,t)).next())});const s=e=>{var t;return(null==(t=e.match(/^data:(.*?);base64,/))?void 0:t[1])||""};const d={view:r.createElement("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"eye",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},r.createElement("path",{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"})),download:r.createElement("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"download",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},r.createElement("path",{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"})),copy:r.createElement("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"copy",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},r.createElement("path",{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"})),del:r.createElement("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"delete",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},r.createElement("path",{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}))};var m=(e,t,n)=>new Promise((r,l)=>{var c=e=>{try{a(n.next(e))}catch(e){l(e)}},o=e=>{try{a(n.throw(e))}catch(e){l(e)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(c,o);a((n=n.apply(e,t)).next())});function v(){const e=r.useRef(null),t=r.useRef(null),[n,l]=r.useState(""),[v,h]=r.useState([]),f=c({callback:{afterInitSuccess(){f.getAll().then(h)}}}),g=e=>m(null,null,function*(){const t=(yield f.get(e))||{},{value:n,name:r}=t;n&&function(e,t="image.png"){const n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}(n,r)}),p=e=>m(null,null,function*(){return new Promise(t=>{const n=new FileReader;n.readAsDataURL(e),n.onload=function(){if(n.result){const r=f.add({name:e.name,value:n.result});t(r)}else t(null)}})}),y=e=>m(null,null,function*(){var t;const n=(null==(t=yield f.get(e))?void 0:t.value)||"";n&&(0,a.Kg)(n)&&function(e){u(this,null,function*(){try{const t="image/png",n=e.split(",")[1],r=atob(n),l=[];for(let e=0;e<r.length;e+=512){const t=r.slice(e,e+512),n=new Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);const c=new Uint8Array(n);l.push(c)}const c=new Blob(l,{type:t}),o=new ClipboardItem({[t]:c});yield navigator.clipboard.write([o]),i.iU.success("Copy Image Success"),console.log("图片已复制到剪贴板！")}catch(e){i.iU.error("Copy Image Error"),console.error("复制失败:",e)}})}(n)}),x=(...e)=>m(null,[...e],function*(e=[]){const t=[];for(let n=0;n<e.length;n++){const r=e[n],l=yield p(r);l&&t.push(l)}return h(e=>[...e,...t]),!0});function w(e){var t;try{const n=Array.from(null==(t=e.clipboardData)?void 0:t.items).map(e=>{if(e.type.includes("image"))return null==e?void 0:e.getAsFile()}).filter(Boolean);x(n).then(e=>{e?i.iU.success("Paste Image Success"):i.iU.error("Paste Image Error")})}catch(e){console.error(e)}}return r.useEffect(()=>{if(e.current)return e.current.removeEventListener("paste",w),e.current.addEventListener("paste",w),()=>{var t;null==(t=e.current)||t.removeEventListener("paste",w)}},[e.current]),r.createElement("div",null,r.createElement("div",{className:"image-preview"},v.map(e=>{const{key:t,value:c}=e,a=s(c);return r.createElement("div",{key:t,className:"image-preview-item"},r.createElement("div",{className:(0,o.xW)("image-preview-item-img",{view:t===n}),onClick:()=>t===n&&l("")},r.createElement("img",{src:c})),r.createElement("div",{className:"control"},r.createElement("div",{onClick:()=>l(t)},d.view),r.createElement("div",{onClick:()=>m(null,null,function*(){return g(t)})},d.download),r.createElement(i.i,{none:!["image/png","image/jpeg"].includes(a),onClick:()=>y(t)},d.copy),r.createElement("div",{className:"del",onClick:()=>{h(e=>e.filter(e=>e.key!==t)),f.del(t)}},d.del)))}),r.createElement("div",{key:"upload",className:"upload",onMouseEnter:()=>{var t;null==(t=e.current)||t.click()},onClick:()=>{var e;null==(e=t.current)||e.click()}},r.createElement("span",null,"Add"),r.createElement("input",{ref:t,type:"file",multiple:!0,style:{display:"none"},onChange:e=>{const t=e.target.files||[];x(t)}})),r.createElement("div",{className:"paste-upload-box"},r.createElement("span",{className:"text"},"Paste"),r.createElement("input",{className:"paste-upload",ref:e}))))}},1814:(e,t,n)=>{function r(e){return null==e||e!=e}function l(e){return void 0===e}n.d(t,{B9:()=>a,Et:()=>u,Gv:()=>o,Im:()=>r,Kg:()=>i,Lm:()=>v,b0:()=>l,cy:()=>s,vH:()=>d});Number.isNaN;function c(e){try{if("object"==typeof(t=e)&&!r(t)&&/Iterator\]$/.test(t.toString()))return"Iterator";const n=Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1];return"Number"===n&&isNaN(e)?"NaN":n}catch(e){return"Undefined"}var t}function o(e){return null!==e&&"object"==typeof e&&"Object"===c(e)}function a(e){return!r(e)&&(o(e)&&0!==Reflect.ownKeys(e).length)}function i(e){return"string"==typeof e}const u=e=>"number"==typeof e&&"Number"===c(e);function s(e){return Array.isArray(e)}function d(e){return!r(e)&&(s(e)&&e.length>0)}new Map([["Image",["png","jpeg","jpg","png","bmp"]],["Video",["mp4","webm","ogg"]],["PDF",["pdf"]],["Word",["doc","docx"]],["Excel",[".xlsx",".xls",".csv"]]]);const m="undefined"!=typeof window,v=e=>"boolean"==typeof e;m&&window?.navigator?.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent)}}]);