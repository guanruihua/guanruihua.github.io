"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[9553],{813:(e,t,a)=>{a.d(t,{C:()=>E,FI:()=>c,DQ:()=>g,Rt:()=>x,wy:()=>i});var l=a(71083),r=a(29108),n=a(17317),o=a(28308);const s="conf|cache",c=()=>(0,o.qg)(localStorage.getItem(s),{}),i=()=>{const[e,t]=(0,n.xI)({serverUrl:"http://localhost:2400"},s);return{conf:e,setConf:e=>{t(e)}}};var u=Object.defineProperty,d=Object.defineProperties,m=Object.getOwnPropertyDescriptors,h=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,y=(e,t,a)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,f=(e,t)=>{for(var a in t||(t={}))p.call(t,a)&&y(e,a,t[a]);if(h)for(var a of h(t))v.call(t,a)&&y(e,a,t[a]);return e};const g=(...e)=>{return t=null,a=[...e],n=function*(e={}){let t=e,{url:a,method:n="get",headers:o={}}=t,s=((e,t)=>{var a={};for(var l in e)p.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&h)for(var l of h(e))t.indexOf(l)<0&&v.call(e,l)&&(a[l]=e[l]);return a})(t,["url","method","headers"]);if((0,r.Kg)(a)&&!a.startsWith("http")){const{serverUrl:e}=c();a=a.startsWith("/")?e+a:e+"/"+a}return(0,l.A)((i=f({url:a,method:n},s),u={headers:f({"Content-Type":"application/json"},o)},d(i,m(u)))).catch(e=>(console.error(e),{}));var i,u},new Promise((e,l)=>{var r=e=>{try{s(n.next(e))}catch(e){l(e)}},o=e=>{try{s(n.throw(e))}catch(e){l(e)}},s=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,o);s((n=n.apply(t,a)).next())});var t,a,n};var b=a(21742),w=a(89218);const E=e=>{(0,w.Dk)(e)?b.iU.success("Copy Success "):b.iU.error("Copy Fail ")},x=e=>{const t=document.querySelector(e);null==t||t.scrollIntoView({behavior:"smooth",block:"start"})}},9553:(e,t,a)=>{a.r(t),a.d(t,{default:()=>oe});var l=a(96540),r=a(21742),n=a(17317);var o=a(29108);const s=e=>{const t=[],a=[];return(0,o.cy)(e)&&e.forEach(({name:e,value:l})=>{t.push(e),a.push(l)}),{xData:t,yData:a}};var c=Object.defineProperty,i=Object.defineProperties,u=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,p=(e,t,a)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,v=(e,t)=>{for(var a in t||(t={}))m.call(t,a)&&p(e,a,t[a]);if(d)for(var a of d(t))h.call(t,a)&&p(e,a,t[a]);return e},y=(e,t)=>i(e,u(t));const f={dataZoom:[{show:!0,type:"slider",startValue:0,yAxisIndex:[0]}],grid:{top:"10%",left:"8%",right:"5%",bottom:"17%",containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}}},g=e=>{const{data:t=[]}=e,{xData:a=[],yData:l=[]}=s(t);return y(v({},f),{xAxis:{type:"value",boundaryGap:!1,minInterval:1,axisLabel:{clickable:!1}},yAxis:{type:"category",boundaryGap:!0,data:a,axisLabel:{show:!0,clickable:!1,lineStyle:{color:"#f2f2f2"},formatter:function(e){let t=e;return t.length>20&&(t=t.substr(0,20)+"..."),t}}},series:[{data:l,type:"bar",label:{show:!0,position:"right",color:"#862633"}}]})},b=g,w={zh_CN:{total:"æ€»æ•°",drawChart:"å›¾è¡¨å·²ç»˜åˆ¶æˆåŠŸå®Œæˆ",startFindData:"å¼€å§‹èŽ·å–ç³»ç»Ÿæ•°æ®...",endFindData:"èŽ·å–ç³»ç»Ÿæ•°æ®å®Œæˆ, å¹¶å¼€å§‹åˆ†æž..."},en_US:{total:"Total",drawChart:"The chart has been successfully drawn",startFindData:"Start retrieving system data ..",endFindData:"Get system data completed and start analysis. .."}},E=(e,t)=>{var a,l;return(null==(a=null==w?void 0:w[e])?void 0:a[t])||(null==(l=w.en_US)?void 0:l[t])||t},x=e=>({t:t=>E(e,t)}),k={bottom:"2%",left:"2%",top:"2%",type:"scroll",textStyle:{align:"left",verticalAlign:"middle",rich:{name:{color:"rgba(0,0,0,0.5)",fontSize:12},value:{color:"rgba(0,0,0,0.5)",fontSize:12},rate:{color:"rgba(0,0,0,0.9)",fontSize:12}}}};const C=(e,t={})=>{const{title:a}=t;let l={};if("draw_chart:any_Chart"===e&&(t.title="Radom Data Title",t.data=new Array(4).fill("").map((e,t)=>{return{name:"Item-"+(t+1),value:(a=30,l=300,a=Math.ceil(a),l=Math.floor(l),Math.floor(Math.random()*(l-a+1))+a)};var a,l}),l=g(t)),"draw_chart:bar"===e&&(l=g(t)),"draw_chart:x_bar"===e&&(l=b(t)),"draw_chart:y_bar"===e&&(l=(e=>{const{data:t=[]}=e,{xData:a=[],yData:l=[]}=s(t);return y(v({},f),{xAxis:{type:"category",data:a},yAxis:{type:"value"},series:[{data:l,type:"bar"}]})})(t)),"draw_chart:pie"===e&&(l=(e=>{const{title:t,lang:a="en_US",data:l=[]}=e,r={};if((0,o.cy)(l)&&l.length>10){const e=l.slice().sort((e,t)=>t-e).slice(0,10).map(e=>e.name);l.forEach(({name:t})=>{r[t]=e.includes(t)})}return{tooltip:{trigger:"item"},legend:k,graphic:{type:"text",left:"center",top:"center",style:{text:E(a,"total")+"\n\n"+l.reduce((e,t)=>e+t.value,0),textAlign:"center",fill:"#333",width:30,height:30,fontSize:14}},series:[{name:t,type:"pie",radius:["30%","49%"],avoidLabelOverlap:!0,minShowLabelAngle:5,itemStyle:{borderColor:"#fff",borderWidth:2},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},data:l}]}})(t)),"draw_chart:line"===e&&(l=(e=>{const{data:t=[]}=e,{xData:a=[],yData:l=[]}=s(t);return{tooltip:{trigger:"axis"},legend:k,xAxis:{type:"category",data:a||[]},yAxis:{type:"value"},series:[{data:l||[],type:"line"}]}})(t)),"draw_chart:lines"===e&&(l=(e=>{const{data:t=[]}=e;let a=[];const l=[];return null==t||t.forEach(e=>{const{name:t}=e;(0,o.Kg)(t)&&(0,o.cy)(e.data)&&(0===a.length&&(a=e.data.map(e=>e.name)),l.push({name:t,type:"line",stack:"Total",data:e.data.map(e=>e.value)}))}),{tooltip:{trigger:"axis"},legend:k,xAxis:{type:"category",boundaryGap:!1,data:a||[]},yAxis:{type:"value"},series:l||[]}})(t)),(0,o.B9)(l))return a&&(l.title={text:a,left:"center"}),l},O=[{type:"function",function:{name:"draw_chart:bar",description:"Draw a bar chart",parameters:{type:"object",properties:{title:{type:"string",description:"The title of the chart, please generate it according to the context"},data:{type:"array",description:"data is an array with two properties, one property is name, and the second property is value, which identifies the value of the item; The values of these two attributes are required"}},required:["title","data"]}}},{type:"function",function:{name:"draw_chart:any_Chart",description:"Draw a bar chart of random Data",parameters:{type:"object",required:["type"],properties:{type:{type:"string",description:"What kind of chart should be drawn"}}}}}];var N=a(71083),P=Object.defineProperty,S=Object.getOwnPropertySymbols,D=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,j=(e,t,a)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,T=(e,t)=>{for(var a in t||(t={}))D.call(t,a)&&j(e,a,t[a]);if(S)for(var a of S(t))A.call(t,a)&&j(e,a,t[a]);return e};const _=e=>{const{url:t,model:a,apiKey:l}=e;return{sendMessage(e){return r=this,n=null,s=function*(){var r,n,s,c,i,u,d,m,h;const{messages:p,tools:v,headers:y={},params:f={}}=e;if(!t)return console.error("LLM / sendMessage / Parameter url are required"),{};if(!(0,o.vH)(p))return console.error("LLM / sendMessage / Parameter messages are incorrect"),{};v&&(0,o.vH)(v)&&!f.tools&&(f.tools=v),l&&!y.Authorization&&(y.Authorization=`Bearer ${l}`),f.tools&&0===(null==v?void 0:v.length)&&delete f.tools;const g=yield N.A.post(null!=(r=null==e?void 0:e.url)?r:t,T({model:null!=(n=e.model)?n:a,messages:p,stream:!1},f),{headers:T({"Content-Type":"application/json"},y)}).catch(e=>(console.error(e),{}));return(null==(i=null==(c=null==(s=null==g?void 0:g.data)?void 0:s.choices)?void 0:c[0])?void 0:i.message)||(null==(h=null==(m=null==(d=null==(u=null==g?void 0:g.data)?void 0:u.data)?void 0:d.choices)?void 0:m[0])?void 0:h.message)},new Promise((e,t)=>{var a=e=>{try{o(s.next(e))}catch(e){t(e)}},l=e=>{try{o(s.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,l);o((s=s.apply(r,n)).next())});var r,n,s}}};var R=a(813);const I=e=>{return t=null,a=null,l=function*(){var t,a,l;try{const r=yield(0,R.DQ)({method:"post",url:"/rag",params:{message:e}});if(console.log("RAG Data: ",null==(t=null==r?void 0:r.data)?void 0:t.data),200===(null==(a=null==r?void 0:r.data)?void 0:a.code)){const e=null==(l=null==r?void 0:r.data)?void 0:l.data;let t="You are a customer service assistant, please answer strictly based on the following information: \n";return e.forEach(e=>{t+=`-  ${e}\n`}),t}}catch(e){console.error(e)}return""},new Promise((e,r)=>{var n=e=>{try{s(l.next(e))}catch(e){r(e)}},o=e=>{try{s(l.throw(e))}catch(e){r(e)}},s=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,o);s((l=l.apply(t,a)).next())});var t,a,l};const M=e=>{return t=null,a=null,l=function*(){var t;const{serverUrl:a}=(0,R.FI)(),{chatId:l,url:r=a+"/ollama/steam/chat",callback:n,messages:o=[]}=e,s=yield fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"deepseek-r1:14b",stream:!0,messages:o.filter(Boolean),chatId:l})});if(!s.body)throw new Error("ReadableStream not supported");const c=s.body.getReader(),i=new TextDecoder;for(;;){const{done:e,value:a}=yield c.read();if(e)break;let l=i.decode(a,{stream:!0});if(!l.startsWith("data: ")){console.log("stop stream");break}{const e=/"delta":{"role":"assistant","content":"(.*?)"},"finish_reason":null}]}/;let a=(null==(t=l.match(e))?void 0:t[1])||"";if("\\u003cthink\\u003e"===a&&(a="<think>"),"\\u003c/think\\u003e"===a&&(a="</think>"),a.includes("\\n")&&(a=a.replaceAll("\\n","\n")),null==n||n({type:"chunk",role:"assistant",content:a}),l.includes("data: [DONE]"))break}}},new Promise((e,r)=>{var n=e=>{try{s(l.next(e))}catch(e){r(e)}},o=e=>{try{s(l.throw(e))}catch(e){r(e)}},s=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,o);s((l=l.apply(t,a)).next())});var t,a,l};const U=e=>{return t=null,a=null,l=function*(){var t;try{const a=yield(0,R.DQ)({method:"post",url:"rag/query",params:{message:e,tableName:"tools"}}),{code:l,data:r}=(null==a?void 0:a.data)||{};if(200===l)return null==(t=null==r?void 0:r[0])?void 0:t.key}catch(e){console.error(e)}return""},new Promise((e,r)=>{var n=e=>{try{s(l.next(e))}catch(e){r(e)}},o=e=>{try{s(l.throw(e))}catch(e){r(e)}},s=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,o);s((l=l.apply(t,a)).next())});var t,a,l};var L=Object.defineProperty,K=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable,H=(e,t,a)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,F=(e,t,a)=>new Promise((l,r)=>{var n=e=>{try{s(a.next(e))}catch(e){r(e)}},o=e=>{try{s(a.throw(e))}catch(e){r(e)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,o);s((a=a.apply(e,t)).next())});const q=e=>{const{chatId:t,model:a,url:l,apiKey:r,SystemPrompt:n,lang:s="en_US",addChartTool:c=!0,functionCall:i={},config:u={}}=e,{t:d}=x(s);return{handleChat:m=>F(null,null,function*(){const h=_({model:a,url:l,apiKey:r});if(!h)return void console.error("LLM init error");const{message:p,callback:v,callbackMessage:y}=m,f=[];p&&f.push({role:"user",content:p});let g,b="";if(null==v||v({role:"user",content:p}),u.enabledRAG){const e=Date.now(),t=yield I(p);null==v||v({role:"assistant rag",content:t,time:e-Date.now()}),g=t,console.log("TAGContent: ",g),b=yield U(p),console.log("toolFlag: ",b)}if(g&&f.unshift({role:"system",content:g}),n&&f.unshift({role:"system",content:n}),0===f.length)return;const w=((e,t={})=>{var a;const{params:l={},props:r={}}=t,{tools:n=O}=r;if("nothing"===e)return;const s=l.tools?l.tools||[]:l.expandTools?[...n,...l.expandTools].filter(Boolean):n||[];if((0,o.vH)(s))for(let t=0;t<s.length;t++){const l=s[t];if((null==(a=null==l?void 0:l.function)?void 0:a.name)===e)return console.log(l),[l]}})(b,{params:m,props:e});if(!(0,o.vH)(w))return void(yield M({chatId:t,callback:v,messages:f}));const E=yield h.sendMessage({messages:[{role:"user",content:p}],tools:w});console.log("llm: ",E),f.push(E);const x=e=>F(null,null,function*(){var l,r;console.log("ðŸš€ ~ handleToolCall ~ msg/tool_calls/0:",null==(l=null==e?void 0:e.tool_calls)?void 0:l[0]);const u=null==(r=null==e?void 0:e.tool_calls)?void 0:r[0],m=null==u?void 0:u.function;if((0,o.Kg)(null==m?void 0:m.name)){const e=((e,t={})=>{var a;try{if((0,o.Kg)(e)){const l=null!=(a=JSON.parse(e.trim()))?a:t;return(0,o.Kg)(null==l?void 0:l.data)&&(l.data=JSON.parse(l.data)),l}return t}catch(a){return console.error(a,"/",e),t}})(m.arguments);let l="";if(b=m.name,(0,o.Kg)(b)&&0===b.indexOf("draw_chart"))try{const t={role:"assistant",content:"",toolType:m.name,chartTitle:null==e?void 0:e.title,chartData:null==e?void 0:e.data};c&&(t.chartOptions=C(m.name,((e,t)=>{for(var a in t||(t={}))G.call(t,a)&&H(e,a,t[a]);if(K)for(var a of K(t))z.call(t,a)&&H(e,a,t[a]);return e})({lang:s},e))),null==v||v(t),l="Please analyze the data of "+e.data}catch(e){console.error(e)}else if(i[m.name]){const t=i[m.name];null==v||v({role:"assistant",content:d("startFindData"),toolType:"assistant-process"}),l=yield t(e),null==v||v({role:"assistant",content:d("endFindData"),toolType:"assistant-process"})}if((0,o.Kg)(l)||(l=JSON.stringify(l)),(0,o.Kg)(a)&&0===(null==a?void 0:a.indexOf("llama3")))return void(yield M({chatId:t,callback:v,messages:[{role:"system",content:n},{role:"user",content:`Summarize based on information ${g} with ${p}`}]}));{f.push({role:"tool",tool_call_id:u.id,name:m.name,content:l});const e=yield h.sendMessage({messages:f,tools:w});return console.log("ðŸš€ ~ handleToolCall ~ msgNext:",e),yield x(e)}}return null==y||y(f),null==v?void 0:v({role:"assistant",content:(null==e?void 0:e.content)||""});var b});return yield x(E)})}},B=[{label:"deepseek-chat",value:"deepseek-chat"},{label:"deepseek-reasoner",value:"deepseek-reasoner"},{label:"llama3.1",value:"llama3.1"},{label:"llama3.2",value:"llama3.2"},{label:"deepseek-r1:14b",value:"deepseek-r1:14b"},{label:"Custom",value:"Custom"}],$=[{label:"https://api.deepseek.com/v1/chat/completions",value:"https://api.deepseek.com/v1/chat/completions"},{label:"ollama/chat",value:"ollama/chat"},{label:"Custom",value:"Custom"}],W=[{value:"1.1",label:"Draw a bar chart using random data"},{value:"2.1",label:"Who are you?"},{value:"3",label:"Greetings without the need for drawing"},{value:"4",label:"Introducing AppPulse+"}];var J=(e,t,a)=>new Promise((l,r)=>{var n=e=>{try{s(a.next(e))}catch(e){r(e)}},o=e=>{try{s(a.throw(e))}catch(e){r(e)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,o);s((a=a.apply(e,t)).next())});const Q=()=>{const[e,t]=(()=>{const e=l.useRef(null);return[e,()=>{const t=e.current;t&&t.scrollTo(0,t.scrollHeight)}]})(),[a,r]=(0,n.xI)({model:"llama3.1",customModel:!1,enabledRAG:!0,apiKey:"",url:"ollama/chat",customURL:!1,selectModelType:"",userPrompt:"ä½ å¥½",messages:[],history:[]},"tool/ai-chat/cache"),s=l.useRef(Date.now());return l.useEffect(()=>{t();let e=setTimeout(()=>{t(),clearTimeout(e)},500);return()=>{clearTimeout(e)}},[]),{state:a,setState:r,historyRef:e,handleChat:e=>J(null,null,function*(){const l=e||a.userPrompt;if(!l)return;const n=q({chatId:s.current,apiKey:a.apiKey,model:a.model,url:a.url,SystemPrompt:'You are a stateless AppPulse+assistant;Your answer should be based on the following rules:\n1. Answer questions in English.\n2. The provided tools have drawing functions, so it is not necessary to use the tools\' functions.\n3. Answer the question directly without any reasoning process (such as "let me think" or "first, I need to...").\n4. Can answer based on the provided information\nProhibited behavior:\n- Prohibit the generation of chart images',lang:"en"===localStorage.language?"en_US":"zh_CN",config:{enabledRAG:a.enabledRAG}});yield null==n?void 0:n.handleChat({message:l,messages:a.messages,callback:e=>{var l;e&&(e.id=Date.now(),(0,o.cy)(a.history)||(a.history=[]),"chunk"===(null==e?void 0:e.type)&&e.content&&"chunk"===(null==(l=a.history.at(-1))?void 0:l.type)?a.history.at(-1).content+=e.content:a.history.push(e),r(a),t())}})}),handleClearHistory:()=>{r({history:[]})},handleSteamStop:()=>J(null,null,function*(){(0,R.DQ)({url:"/ollama/steam/chat/stop",method:"post",params:{chatId:s.current}})})}};function Y(e){const{state:t,setState:a,handleClearHistory:n,handleStop:o}=e,{conf:s,setConf:c}=(0,R.wy)();return l.createElement("div",{className:"left-aside"},l.createElement(r.i,{className:"ai-model"},l.createElement("div",{className:"item"},l.createElement("div",{className:"label"},"Server URL"),l.createElement(r.pd,{value:s.serverUrl,onChange:e=>c({serverUrl:e.target.value})})),l.createElement("div",{className:"item"},l.createElement("div",{className:"label"}," Api Key"),l.createElement(r.pd,{value:t.apiKey,onChange:e=>a({apiKey:e.target.value})})),l.createElement("div",{className:"item"},l.createElement("div",{className:"label"},"Model"),l.createElement(r.so,{className:"model-box"},B.map(({label:e,value:n})=>l.createElement(r.i,{key:n,className:"item",classNames:{select:t.customModel?"Custom"===n:n===t.model},onClick:()=>{var e;a("Custom"!==(e=n)?{model:e,customModel:!1}:{model:"",customModel:!0})}},e)),t.customModel&&l.createElement(r.pd,{value:t.model,onChange:e=>a({model:e.target.value})}))),l.createElement("div",{className:"item"},l.createElement("div",{className:"label"},"URL"),l.createElement(r.so,{className:"url-box"},$.map(({label:e,value:n})=>l.createElement(r.i,{key:n,className:"item",classNames:{select:t.customURL?"Custom"===n:n===t.url},onClick:()=>{var e;a("Custom"!==(e=n)?{url:e,customURL:!1}:{url:"",customURL:!0})}},e)),t.customURL&&l.createElement(r.pd,{value:t.url,onChange:e=>a({url:e.target.value})})))),l.createElement(r.$n,{type:t.enabledRAG?"primary":"default",onClick:()=>{a({enabledRAG:!t.enabledRAG})}},"Enabled RAG"),l.createElement(r.$n,{onClick:()=>o()},"Stop"),l.createElement(r.$n,{onClick:()=>n()},"Clear History"))}var V=a(11483);function X(e){const{loading:t,handleUserChat:a,Suggest:r}=e;return l.createElement("div",{className:"right-aside"},l.createElement(V.Rh,{loading:t},l.createElement("div",{className:"suggest-box"},r.map((e,t)=>{const{value:r,label:n}=e;return l.createElement("div",{key:t,className:"suggest-item",onClick:()=>a(n)},n)}))))}const Z=l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},l.createElement("path",{fill:"currentColor",d:"M20.04 2.323c1.016-.355 1.992.621 1.637 1.637l-5.925 16.93c-.385 1.098-1.915 1.16-2.387.097l-2.859-6.432l4.024-4.025a.75.75 0 0 0-1.06-1.06l-4.025 4.024l-6.432-2.859c-1.063-.473-1-2.002.097-2.387z"})),ee=l.createElement("svg",{className:"think-control-arrow",xmlns:"http://www.w3.org/2000/svg",width:"0.5em",height:"1em",viewBox:"0 0 12 24"},l.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M10.157 12.711L4.5 18.368l-1.414-1.414l4.95-4.95l-4.95-4.95L4.5 5.64l5.657 5.657a1 1 0 0 1 0 1.414"}));var te=a(2391),ae=a(93250);const le=({value:e=""})=>l.createElement(te.oz,{remarkPlugins:[ae.A]},e);function re(e){var t;const{state:a,historyRef:n}=e;return l.createElement("div",{className:"chat-history",ref:n},null==(t=null==a?void 0:a.history)?void 0:t.map(e=>{const{id:t,role:a="",content:n,chartOptions:s,toolType:c}=e;if(s)return l.createElement(r.i,{key:t,classNames:[a,"chart",c]},l.createElement(r.t1,{style:{minHeight:300},options:s}));if(a.includes("rag"))return l.createElement(r.i,{key:t,className:a},l.createElement(r.i,{className:"think-box"},l.createElement("div",{className:"think-control",onClick:e=>{var t,a;const l=null==(a=null==(t=e.currentTarget)?void 0:t.dataset)?void 0:a.value;e.currentTarget.dataset.value="bottom"===l?"":"bottom"}},l.createElement("span",{className:"think-control-label"},"RAG"),ee),l.createElement(r.i,{className:"think content rag"},l.createElement(le,{value:n}))));if((0,o.Kg)(n)&&(n.includes("<think>")&&n.includes("</think>")||0===n.indexOf("<think>"))){const[e,o]=n.replace(/^<think>/,"").split("</think>");return l.createElement(r.i,{key:t,className:a},l.createElement(r.i,{none:!e,className:"think-box"},l.createElement("div",{className:"think-control",onClick:e=>{var t,a;const l=null==(a=null==(t=e.currentTarget)?void 0:t.dataset)?void 0:a.value;e.currentTarget.dataset.value="bottom"===l?"":"bottom"}},l.createElement("span",{className:"think-control-label"},"Deep Thinking"),ee),l.createElement(r.i,{none:!e,className:"think"},l.createElement(le,{value:e}))),l.createElement("div",{className:"content markdown"},l.createElement(le,{value:o})))}return l.createElement(r.i,{key:t,className:a},l.createElement("div",{className:"content markdown"},l.createElement(le,{value:n})))}))}var ne=(e,t,a)=>new Promise((l,r)=>{var n=e=>{try{s(a.next(e))}catch(e){r(e)}},o=e=>{try{s(a.throw(e))}catch(e){r(e)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(n,o);s((a=a.apply(e,t)).next())});function oe(){const{historyRef:e,state:t,setState:a,handleChat:n,handleClearHistory:o,handleSteamStop:s}=Q(),[c,i]=l.useState(!1),u=e=>ne(null,null,function*(){c||(i(!0),yield n(e),i(!1))});return l.createElement("div",{className:"tool-ai-chat"},l.createElement(Y,{state:t,setState:a,handleClearHistory:o,handleStop:()=>ne(null,null,function*(){s(),i(!1)})}),l.createElement("div",{className:"chat-container"},l.createElement(re,{state:t,historyRef:e}),l.createElement("div",{className:"user-prompt"},l.createElement(V.Rh,{loading:c},l.createElement("textarea",{value:t.userPrompt,onKeyDown:e=>{"Enter"===e.code&&(e.preventDefault(),u())},onChange:e=>{a({userPrompt:e.target.value})}}),l.createElement("div",{className:"user-prompt-controls"},l.createElement(r.i,{className:"btn-send",classNames:{disabled:c||!(null==t?void 0:t.userPrompt)},onClick:()=>u()},Z))))),l.createElement(X,{loading:c,Suggest:W,handleUserChat:u}))}},11483:(e,t,a)=>{a.d(t,{mc:()=>m,Rh:()=>w});var l=a(96540);a(89218);var r=a(21742),n=Object.defineProperty,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,i=(e,t,a)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,u=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&i(e,a,t[a]);if(o)for(var a of o(t))c.call(t,a)&&i(e,a,t[a]);return e},d=(e,t)=>{var a={};for(var l in e)s.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&o)for(var l of o(e))t.indexOf(l)<0&&c.call(e,l)&&(a[l]=e[l]);return a};function m(e){const t=e,{children:a,header:n,containerClassName:o,className:s,style:c}=t,i=d(t,["children","header","containerClassName","className","style"]);return l.createElement(r.i,{className:["layout-container",location.hash.replace("#/","").replace("/","__"),o]},l.createElement(r.i,u({className:["layout-box",s],style:c},i),a))}var h=Object.defineProperty,p=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable,f=(e,t,a)=>t in e?h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,g=(e,t)=>{for(var a in t||(t={}))v.call(t,a)&&f(e,a,t[a]);if(p)for(var a of p(t))y.call(t,a)&&f(e,a,t[a]);return e},b=(e,t)=>{var a={};for(var l in e)v.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&p)for(var l of p(e))t.indexOf(l)<0&&y.call(e,l)&&(a[l]=e[l]);return a};function w(e){const t=e,{loading:a=!0,children:n}=t,o=b(t,["loading","children"]);return l.createElement(r.i,g({className:"au-loading",classNames:{loading:a}},o),n,a&&l.createElement(r.i,{classNames:"au-loading-bg"},l.createElement(r.i,{classNames:"au-loading-spin"})))}}}]);