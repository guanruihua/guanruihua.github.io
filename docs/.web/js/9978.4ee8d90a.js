"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[9978],{9978:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var n=s(5296),a=s(6045),o=s(9404),c=s(8780),l=(e,t,s)=>new Promise((n,a)=>{var o=e=>{try{l(s.next(e))}catch(e){a(e)}},c=e=>{try{l(s.throw(e))}catch(e){a(e)}},l=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,c);l((s=s.apply(e,t)).next())});function r(e){const{name:t}=e,[s,r]=(0,a.xI)({value:""}),{sendMessage:u,messages:i=[]}=function(e,t){const[s,c]=(0,n.useState)(!1),[r,u]=(0,a.xI)({messages:[]},t),{messages:i=[]}=r,m=(0,n.useRef)(null),d={messages:i,onMessage(e){return l(this,null,function*(){var t,s;const n=(0,o.qg)(yield null==(s=null==(t=e.data)?void 0:t.text)?void 0:s.call(t),void 0);if(console.log(n,this.messages),n&&n.id){const e=(null==this?void 0:this.messages)||[];if(e.map(e=>e.id).includes(n.id))return;e.push(n),u({messages:e}),this.messages=e}})}};return(0,n.useEffect)(()=>{const t=new WebSocket(e);return t.onopen=()=>{c(!0),console.log("WebSocket connected")},t.onclose=()=>{c(!1),console.log("WebSocket disconnected")},t.onmessage=d.onMessage,t.onerror=e=>{console.error("WebSocket error:",e)},m.current=t,()=>{t.close()}},[e]),{isReady:s,messages:i,sendMessage:e=>!(!m.current||!s||(m.current.send(e),0))}}("ws://localhost:2410","/tool/webSocket/cache|"+t);return n.createElement("div",{className:"webSocket-user"},n.createElement("h3",null,n.createElement("span",null,t)),n.createElement("div",{className:"webSocket-user-message-box"},null==i?void 0:i.map((e,t)=>{const{type:s,name:a,content:o}=e;return n.createElement("div",{key:t},a,"-",o)})),n.createElement("div",{className:"webSocket-user-content"},n.createElement(c.pd,{value:s.value,onChange:e=>{const t=e.target.value;r({value:t})}}),n.createElement(c.$n,{onClick:()=>(()=>{const e={id:Date.now(),type:"message",name:t,content:s.value||""};u((0,o.dI)(e))})()},"Send")))}function u(){return n.createElement("div",{className:"tool-webSocket"},n.createElement("div",{className:"tool-webSocket-box"},n.createElement(r,{name:"User1"}),n.createElement(r,{name:"User2 "})))}}}]);