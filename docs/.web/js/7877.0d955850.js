"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[7877],{1814:(e,t,n)=>{function r(e){return null==e||e!=e}function o(e){return void 0===e}n.d(t,{B9:()=>l,Et:()=>s,Gv:()=>u,Im:()=>r,Kg:()=>c,Lm:()=>m,ZX:()=>i,b0:()=>o,cy:()=>d,vH:()=>f});Number.isNaN;function a(e){try{if("object"==typeof(t=e)&&!r(t)&&/Iterator\]$/.test(t.toString()))return"Iterator";const n=Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1];return"Number"===n&&isNaN(e)?"NaN":n}catch(e){return"Undefined"}var t}function u(e){return null!==e&&"object"==typeof e&&"Object"===a(e)}function l(e){return!r(e)&&(u(e)&&0!==Reflect.ownKeys(e).length)}function c(e){return"string"==typeof e}const s=e=>"number"==typeof e&&"Number"===a(e);function i(e){return!!s(e)||(c(e)&&(e=e.trim()),!r(e)&&""!==e&&!1===Number.isNaN(Number(e)))}function d(e){return Array.isArray(e)}function f(e){return!r(e)&&(d(e)&&e.length>0)}new Map([["Image",["png","jpeg","jpg","png","bmp"]],["Video",["mp4","webm","ogg"]],["PDF",["pdf"]],["Word",["doc","docx"]],["Excel",[".xlsx",".xls",".csv"]]]);const v="undefined"!=typeof window,m=e=>"boolean"==typeof e;v&&window?.navigator?.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent)},6045:(e,t,n)=>{n.d(t,{xI:()=>i});var r=n(5296);function o(e){return null==e||e!=e}function a(e){try{if("object"==typeof(t=e)&&!o(t)&&/Iterator\]$/.test(t.toString()))return"Iterator";const n=Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1];return"Number"===n&&isNaN(e)?"NaN":n}catch(e){return"Undefined"}var t}function u(e){return"string"==typeof e}const l=e=>"number"==typeof e&&"Number"===a(e);function c(e){return!o(e)&&(function(e){return Array.isArray(e)}(e)&&e.length>0)}const s="undefined"!=typeof window;function i(e={},t,n=localStorage){const[o,a]=(0,r.useState)(e),s=e=>{if(a(e),t)try{n.setItem(t,JSON.stringify(e))}catch(e){return void console.warn(e)}};return(0,r.useEffect)(()=>{if(t)try{const e=n.getItem(t);if(!e||"{}"===e)return;s(JSON.parse(e))}catch(e){return}},[t,n]),[o,(e,t=!1)=>{const n="function"==typeof e?e(o):e;s(t?n:{...o,...n})},t=>{if(c(t)){const n={...o};return t.forEach(t=>{(u(t)||l(t))&&(n[t]=e[t])}),void s(n)}s(e)}]}s&&window?.navigator?.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent)},7877:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(5296),o=n(3149),a=n(6045),u=n(1814);const l=()=>{const[e,t]=(0,a.xI)({method:"post",url:"http://localhost:2400/sse",values:[]},"/tool/sse|cache"),n=r.useRef(e);r.useEffect(()=>{n.current=e},[e]);const o=r.useRef(void 0);return{eventRef:o,state:e,setState:t,handleStartSSE:()=>{return n=null,r=null,a=function*(){var n,r,a;if(!e.url)return;if("post"===e.method){const o=yield fetch(e.url,{method:"POST",headers:{"Content-Type":"text/event-stream"}});if(!o.body)throw new Error("ReadableStream not supported");const l=o.body.getReader(),c=new TextDecoder;for((0,u.cy)(e.values)||(e.values=[]);;){const{done:o,value:u}=yield l.read();if(o)break;let s=c.decode(u,{stream:!0});if(s.startsWith("data: ")){const r=/"delta":{"role":"assistant","content":"(.*?)"},"finish_reason":null}]}/,o=null==(n=s.substring(5).trim().match(r))?void 0:n[1];console.log(o),e.values.push(o),t(e);continue}const i=null==(a=null==(r=s.split("\n"))?void 0:r.pop)?void 0:a.call(r);i&&(e.values.push(i),t(e))}return}const l=new EventSource(e.url);o.current=l,l.addEventListener("customEvent",n=>{const{type:r,content:a}=JSON.parse(n.data);if("stop"===r)return l.close(),o.current=void 0,void t(e);(0,u.cy)(e.values)||(e.values=[]),e.values.push(a),t(e)}),l.onerror=function(n){l.close(),o.current=void 0,t(e)}},new Promise((e,t)=>{var o=e=>{try{l(a.next(e))}catch(e){t(e)}},u=e=>{try{l(a.throw(e))}catch(e){t(e)}},l=t=>t.done?e(t.value):Promise.resolve(t.value).then(o,u);l((a=a.apply(n,r)).next())});var n,r,a},handleClearHistory:()=>{t({values:[]})},handleStopSSE:()=>{var n;(null==(n=o.current)?void 0:n.close)&&(o.current.close(),o.current=void 0,t(e))}}};function c(){var e,t;const{eventRef:n,state:a,setState:u,handleStartSSE:c,handleClearHistory:s,handleStopSSE:i}=l();return r.createElement("div",{className:"tool-sse"},r.createElement("h4",null,"SSE"),r.createElement("div",{className:"tool-sse-box"},r.createElement(o.so,{row:!0,className:"tool-sse-box-left"},r.createElement("div",null,"SSE URL"),r.createElement(o.pd,{value:a.url,onChange:e=>{u({url:e.target.value})}}),r.createElement("div",null,"Method"),r.createElement(o.so,{style:{width:"100%"}},r.createElement(o.$n,{type:"post"===a.method?"primary":"default",onClick:()=>u({method:"post"})},"POST"),r.createElement(o.$n,{type:"get"===a.method?"primary":"default",onClick:()=>u({method:"get"})},"GET")),r.createElement(o.$n,{onClick:()=>c()}," Send SSE "),r.createElement(o.$n,{disabled:!n.current,onClick:()=>i()},"Stop SSE"),r.createElement(o.$n,{disabled:n.current,onClick:()=>s()},"Clear History")),r.createElement("div",{className:"tool-sse-box-content"},(null==(t=null==(e=null==a?void 0:a.values)?void 0:e.join)?void 0:t.call(e,""))||"")))}}}]);