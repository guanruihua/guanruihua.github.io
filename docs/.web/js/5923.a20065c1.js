"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[5923],{2942:(e,t,s)=>{s.d(t,{gQ:()=>h,ni:()=>a,T_:()=>n,j:()=>r});var i=s(5296);const a=(e,t,s)=>{i.useEffect(()=>{const i=document.createElement("script");return i.src=e,i.onload=()=>{null==t||t()},i.onerror=()=>{console.log(e,"加载失败")},document.body.appendChild(i),()=>{null==s||s(),document.body.removeChild(i)}},[])},r=(e,t,s)=>{i.useEffect(()=>{const i=Promise.all(e.map(e=>new Promise((t,s)=>{const i=document.createElement("script");i.src=e,i.onload=()=>{t(i)},i.onerror=()=>{console.log(e,"加载失败"),s(void 0)},document.body.appendChild(i)}))).then(e=>{null==t||t()});return()=>{null==s||s(),null==i||i.then(e=>{e&&document.body.removeChild(e)})}},[])},n=(e,t,s)=>{i.useEffect(()=>{const i=Promise.all(e.map(e=>new Promise((t,s)=>{const i=document.createElement("link");i.rel="stylesheet",i.href=e,i.onload=()=>{t(i)},i.onerror=()=>{console.log(e,"加载失败"),s(void 0)},document.head.appendChild(i)}))).then(e=>{null==t||t()});return()=>{null==s||s(),null==i||i.then(e=>{e&&document.head.removeChild(e)})}},[])};var o=(e,t,s)=>new Promise((i,a)=>{var r=e=>{try{o(s.next(e))}catch(e){a(e)}},n=e=>{try{o(s.throw(e))}catch(e){a(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(r,n);o((s=s.apply(e,t)).next())});function h(e){const[t,s]=i.useState("");return i.useEffect(()=>{o(null,null,function*(){const t=localStorage.getItem(e);t&&s(t||""),fetch(e).then(t=>o(null,null,function*(){const i=yield t.text();localStorage.setItem(e,i||""),s(i)})).catch(console.error)})},[]),[t,s]}},5923:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var i=s(5296),a=s(2942),r=Object.defineProperty,n=(e,t,s)=>((e,t,s)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);const o=()=>{(0,a.ni)("/js/gsap.3.12.5.min.js",()=>{const e=document.querySelector(".image");new class{constructor(e){n(this,"DOM",{el:null,innerElems:null,debugPanel:null,cursorDrag:null}),n(this,"bgImage"),n(this,"currentShape","rectangle"),n(this,"currentEffect","stroke"),n(this,"duration",.8),n(this,"ease","power2.inOut"),n(this,"scaleInterval",.06),n(this,"rotationInterval",15),n(this,"parallaxStrength",20),n(this,"innerTotal",10),n(this,"shapeSize",45),n(this,"transformOrigin","50% 50%"),n(this,"mouseX",0),n(this,"mouseY",0),n(this,"centerX",0),n(this,"centerY",0),n(this,"isHovered",!1),n(this,"isDragging",!1),n(this,"dragStartY",0),n(this,"dragDistance",0),n(this,"smoothDragDistance",0),n(this,"isRotationActive",!1),n(this,"currentRotation",0),n(this,"currentScale",1),n(this,"layerOutlines",[]),n(this,"layerShadows",[]),n(this,"dragLerpFactor",.1),n(this,"animationFrame",null),n(this,"hoverTimeline",null),n(this,"isTransitioning",!1),this.DOM={el:e,debugPanel:document.getElementById("debugPanel"),cursorDrag:document.getElementById("cursorDrag")},this.bgImage=/(?:\(['"]?)(.*?)(?:['"]?\))/.exec(this.DOM.el.style.backgroundImage)[1],gsap.set(this.DOM.el,{backgroundImage:"none"}),this.createLayers(),gsap.set(this.DOM.el,{transformOrigin:this.transformOrigin}),this.createLayerOutlines(),this.createHoverTimeline(),this.initEvents(),this.initShapeControls(),this.initEffectControls(),this.startAnimationLoop()}createLayers(){let e="";for(let t=0;t<this.innerTotal;t++){e+=`<div class="image__element ${0===t?"rectangle":this.currentShape} ${0===t?"base-layer":""}" style="background-image:url(${this.bgImage})" data-layer="${t}"></div>`}this.DOM.el.innerHTML=e,this.DOM.innerElems=this.DOM.el.querySelectorAll(".image__element"),this.updateCenter()}updateCenter(){const e=this.DOM.el.getBoundingClientRect();this.centerX=e.left+e.width/2,this.centerY=e.top+e.height/2}createLayerOutlines(){this.layerOutlines.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this.layerOutlines=[],this.layerShadows.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this.layerShadows=[],this.DOM.innerElems.forEach((e,t)=>{if(0===t)return;const s=e.querySelector(".layer-outline"),i=e.querySelector(".layer-shadow");s&&s.remove(),i&&i.remove();const a=document.createElement("div");a.className="layer-outline",a.setAttribute("data-layer",t);const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("viewBox","0 0 100 100"),r.setAttribute("preserveAspectRatio","none");const n=document.createElementNS("http://www.w3.org/2000/svg","path"),o=this.getLayerShapePath(t);n.setAttribute("d",o),n.setAttribute("stroke","#ffffff"),n.setAttribute("stroke-width","1"),n.setAttribute("fill","none"),n.setAttribute("vector-effect","non-scaling-stroke"),n.style.filter="drop-shadow(0 0 2px rgba(255, 255, 255, 0.5))",r.appendChild(n),a.appendChild(r);const h=document.createElement("div");h.className="layer-shadow",h.setAttribute("data-layer",t);const c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("viewBox","0 0 100 100"),c.setAttribute("preserveAspectRatio","none");for(let e=0;e<3;e++){const s=document.createElementNS("http://www.w3.org/2000/svg","path"),i=this.getLayerShapePath(t);s.setAttribute("d",i);const a=.4-.08*e,r=3-.8*e;s.setAttribute("fill","none"),s.setAttribute("stroke",`rgba(0, 0, 0, ${a})`),s.setAttribute("stroke-width",r),s.setAttribute("vector-effect","non-scaling-stroke"),c.appendChild(s)}h.appendChild(c),e.appendChild(a),e.appendChild(h),this.layerOutlines.push(a),this.layerShadows.push(h)})}getLayerShapePath(e){switch(this.currentShape){case"rectangle":return"M 0 0 L 100 0 L 100 100 L 0 100 Z";case"triangle":return"M 50 5 L 10 95 L 90 95 Z";case"chevron":return"M 75 0 L 100 50 L 75 100 L 0 100 L 25 50 L 0 0 Z";case"oval":return"M 50 15 C 74.85 15 95 31.32 95 50 C 95 68.68 74.85 85 50 85 C 25.15 85 5 68.68 5 50 C 5 31.32 25.15 15 50 15 Z";default:return""}}startAnimationLoop(){const e=()=>{this.smoothDragDistance+=(this.dragDistance-this.smoothDragDistance)*this.dragLerpFactor,this.isHovered&&!this.isTransitioning&&(this.isRotationActive?(this.updateDragRotation(),this.updateLayerOutlines()):this.isDragging||(this.updateParallax(),this.updateLayerOutlines())),this.updateDebugInfo(),this.animationFrame=requestAnimationFrame(e)};e()}updateParallax(){const e=(this.mouseX-this.centerX)/(this.DOM.el.offsetWidth/2),t=(this.mouseY-this.centerY)/(this.DOM.el.offsetHeight/2);this.DOM.innerElems.forEach((s,i)=>{if(0===i)return;const a=.2*i,r=e*this.parallaxStrength*a*.5,n=t*this.parallaxStrength*a*.5;gsap.set(s,{x:r,y:n,z:10*i,transformPerspective:1e3})})}updateDragRotation(){const e=Math.min(Math.abs(this.smoothDragDistance)/100,1);this.DOM.innerElems.forEach((t,s)=>{if(0===s)return;const i=this.smoothDragDistance/2*e*(.3*s),a=(this.mouseX-this.centerX)/(this.DOM.el.offsetWidth/2),r=(this.mouseY-this.centerY)/(this.DOM.el.offsetHeight/2),n=.3*s,o=a*this.parallaxStrength*n,h=r*this.parallaxStrength*n;gsap.set(t,{x:o,y:h,z:15*s,rotationX:15*r*e,rotationY:-15*a*e,rotationZ:i,transformPerspective:1e3,transformStyle:"preserve-3d"})}),this.currentRotation=this.smoothDragDistance/2,this.currentScale=1+2*Math.abs(e)}updateLayerOutlines(){this.updateEffectVisibility()}updateDebugInfo(){if(!this.DOM.debugPanel)return;const e=this.DOM.debugPanel.querySelector("#rotationInfo"),t=this.DOM.debugPanel.querySelector("#scaleInfo"),s=this.DOM.debugPanel.querySelector("#edgesInfo");if(e&&(e.textContent=`rotation: ${this.currentRotation.toFixed(1)}`),t&&(t.textContent=`scale: ${this.currentScale.toFixed(1)}`),s){const e=this.getShapeEdgeCount();s.textContent=`edges: ${e.toFixed(1)}`}}getShapeEdgeCount(){switch(this.currentShape){case"rectangle":return 4;case"triangle":return 3;case"chevron":return 6;default:return 0}}applyCurrentShape(){this.DOM.innerElems.forEach((e,t)=>{0!==t&&(e.classList.remove("rectangle","triangle","chevron","oval"),e.classList.add(this.currentShape))}),this.createLayerOutlines()}initShapeControls(){const e=document.querySelectorAll(".shape-btn");e.forEach(t=>{t.addEventListener("click",()=>{const s=t.dataset.shape;s===this.currentShape||this.isTransitioning||(this.changeShape(s),e.forEach(e=>e.classList.remove("active")),t.classList.add("active"))})})}initEffectControls(){const e=document.querySelectorAll(".effect-btn");e.forEach(t=>{t.addEventListener("click",()=>{const s=t.dataset.effect;s===this.currentEffect||this.isTransitioning||(this.changeEffect(s),e.forEach(e=>e.classList.remove("active")),t.classList.add("active"))})})}changeEffect(e){this.currentEffect=e,this.updateEffectVisibility()}updateEffectVisibility(){this.layerOutlines.forEach(e=>{"stroke"===this.currentEffect&&this.isRotationActive?e.classList.add("active"):e.classList.remove("active")}),this.layerShadows.forEach(e=>{"shade"===this.currentEffect&&this.isRotationActive?e.classList.add("active"):e.classList.remove("active")})}changeShape(e){if(this.isTransitioning)return;this.isTransitioning=!0;new Promise(e=>{this.hoverTimeline&&this.hoverTimeline.pause(),gsap.to(this.DOM.innerElems,{scale:1,x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,duration:.4,ease:"power2.out",onComplete:e}),this.isRotationActive=!1,this.DOM.el.classList.remove("rotation-active"),this.dragDistance=0,this.smoothDragDistance=0,this.currentRotation=0,this.currentScale=1,this.layerOutlines.forEach(e=>{e.classList.remove("active")}),this.layerShadows.forEach(e=>{e.classList.remove("active")})}).then(()=>{this.currentShape=e,this.applyCurrentShape(),this.createHoverTimeline(),this.isHovered&&this.hoverTimeline.play(),this.isTransitioning=!1})}createHoverTimeline(){const e=e=>{let t=1-this.scaleInterval*e;return t>=0?t:0};this.hoverTimeline&&this.hoverTimeline.kill();const t=Array.from(this.DOM.innerElems).reverse();this.hoverTimeline=gsap.timeline({paused:!0}).to(t,{scale:(t,s)=>{const i=Array.from(this.DOM.innerElems).indexOf(s);return e(i)},duration:this.duration,ease:this.ease,stagger:.1})}initEvents(){this.DOM.el.addEventListener("mouseenter",()=>{this.isTransitioning||(this.isHovered=!0,this.updateCenter(),this.hoverTimeline.play(),this.DOM.cursorDrag&&(this.DOM.cursorDrag.style.opacity="1"))}),this.DOM.el.addEventListener("mouseleave",()=>{this.isHovered=!1,this.isTransitioning||this.hoverTimeline.reverse(),this.resetTransforms(),this.DOM.cursorDrag&&(this.DOM.cursorDrag.style.opacity="0")}),this.DOM.el.addEventListener("mousemove",e=>{this.mouseX=e.clientX,this.mouseY=e.clientY,this.DOM.cursorDrag&&(this.DOM.cursorDrag.style.left=e.clientX+"px",this.DOM.cursorDrag.style.top=e.clientY+"px")}),document.addEventListener("mousemove",e=>{this.DOM.cursorDrag&&this.isHovered&&(this.DOM.cursorDrag.style.left=e.clientX+"px",this.DOM.cursorDrag.style.top=e.clientY+"px")}),this.DOM.el.addEventListener("mousedown",e=>{this.isTransitioning||(this.isDragging=!0,this.dragStartY=e.clientY,this.DOM.el.classList.add("dragging"),this.DOM.cursorDrag&&this.DOM.cursorDrag.classList.add("hide-up"),e.preventDefault())}),document.addEventListener("mousemove",e=>{this.isDragging&&!this.isTransitioning&&(this.dragDistance=e.clientY-this.dragStartY,Math.abs(this.dragDistance)>30&&!this.isRotationActive&&(this.isRotationActive=!0,this.DOM.el.classList.add("rotation-active")))}),document.addEventListener("mouseup",()=>{this.isDragging&&(this.isDragging=!1,this.DOM.el.classList.remove("dragging"),this.DOM.cursorDrag&&this.isHovered&&this.DOM.cursorDrag.classList.remove("hide-up"),gsap.to(this,{dragDistance:0,duration:.5,ease:"power2.out"}))}),window.addEventListener("resize",()=>{this.updateCenter(),this.createLayerOutlines()}),this.DOM.el.addEventListener("touchstart",e=>{this.isTransitioning||(this.isDragging=!0,this.dragStartY=e.touches[0].clientY,this.DOM.el.classList.add("dragging"),e.preventDefault())}),document.addEventListener("touchmove",e=>{this.isDragging&&!this.isTransitioning&&(this.dragDistance=e.touches[0].clientY-this.dragStartY,Math.abs(this.dragDistance)>30&&!this.isRotationActive&&(this.isRotationActive=!0,this.DOM.el.classList.add("rotation-active")))}),document.addEventListener("touchend",()=>{this.isDragging&&(this.isDragging=!1,this.DOM.el.classList.remove("dragging"),gsap.to(this,{dragDistance:0,duration:.5,ease:"power2.out"}))})}resetTransforms(){this.DOM.innerElems.forEach((e,t)=>{0!==t&&gsap.to(e,{x:0,y:0,z:0,rotationX:0,rotationY:0,rotationZ:0,duration:.6,ease:"power2.out"})}),gsap.to(this,{smoothDragDistance:0,duration:.6,ease:"power2.out"}),this.isRotationActive=!1,this.DOM.el.classList.remove("rotation-active"),this.currentRotation=0,this.currentScale=1,this.layerOutlines.forEach(e=>{e.classList.remove("active")}),this.layerShadows.forEach(e=>{e.classList.remove("active")})}destroy(){this.animationFrame&&cancelAnimationFrame(this.animationFrame),this.hoverTimeline&&this.hoverTimeline.kill(),this.layerOutlines.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this.layerShadows.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)})}}(e)})};function h(){return o(),i.createElement("div",{className:"animation__repetition-image"},i.createElement("div",{className:"main-container"},i.createElement("div",{className:"image",style:{backgroundImage:"url('https://cdn.prod.website-files.com/65e61ac90950149fdb15e419/685027578326569ff9bb118d_2025-06-16%2017.16.41.jpg')"}})),i.createElement("div",{className:"controls"},i.createElement("div",{className:"shape-controls"},i.createElement("button",{className:"shape-btn active","data-shape":"rectangle"},"1"),i.createElement("button",{className:"shape-btn","data-shape":"triangle"},"2"),i.createElement("button",{className:"shape-btn","data-shape":"chevron"},"3"),i.createElement("button",{className:"shape-btn","data-shape":"oval"},"4")),i.createElement("div",{className:"effect-controls"},i.createElement("button",{className:"effect-btn active","data-effect":"stroke"},"STROKE"),i.createElement("span",null,"OR"),i.createElement("button",{className:"effect-btn","data-effect":"shade"},"SHADE"))),i.createElement("div",{className:"cursor-drag",id:"cursorDrag"},i.createElement("span",{className:"drag-text"},"DRAG")),i.createElement("div",{className:"debug-panel",id:"debugPanel"},i.createElement("div",{className:"debug-info"},i.createElement("span",{id:"rotationInfo"},"rotation: 0.0"),i.createElement("span",{id:"scaleInfo"},"scale: 1.0"),i.createElement("span",{id:"edgesInfo"},"edges: 0.0"))))}}}]);