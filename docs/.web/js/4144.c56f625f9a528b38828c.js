"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[4144],{813:(e,t,a)=>{a.d(t,{C:()=>g,FI:()=>s,DQ:()=>b,Rt:()=>k,wy:()=>i});var l=a(71083),n=a(29108),r=a(17317),o=a(28308);const c="conf|cache",s=()=>(0,o.qg)(localStorage.getItem(c),{}),i=()=>{const[e,t]=(0,r.xI)({serverUrl:"http://localhost:2400"},c);return{conf:e,setConf:e=>{t(e)}}};var d=Object.defineProperty,u=Object.defineProperties,m=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,p=(e,t,a)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,y=(e,t)=>{for(var a in t||(t={}))h.call(t,a)&&p(e,a,t[a]);if(v)for(var a of v(t))f.call(t,a)&&p(e,a,t[a]);return e};const b=(...e)=>{return t=null,a=[...e],r=function*(e={}){let t=e,{url:a,method:r="get",headers:o={}}=t,c=((e,t)=>{var a={};for(var l in e)h.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&v)for(var l of v(e))t.indexOf(l)<0&&f.call(e,l)&&(a[l]=e[l]);return a})(t,["url","method","headers"]);if((0,n.Kg)(a)&&!a.startsWith("http")){const{serverUrl:e}=s();a=a.startsWith("/")?e+a:e+"/"+a}return(0,l.A)((i=y({url:a,method:r},c),d={headers:y({"Content-Type":"application/json"},o)},u(i,m(d)))).catch(e=>(console.error(e),{}));var i,d},new Promise((e,l)=>{var n=e=>{try{c(r.next(e))}catch(e){l(e)}},o=e=>{try{c(r.throw(e))}catch(e){l(e)}},c=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,o);c((r=r.apply(t,a)).next())});var t,a,r};var C=a(21742),N=a(89218);const g=e=>{(0,N.Dk)(e)?C.iU.success("Copy Success "):C.iU.error("Copy Fail ")},k=e=>{const t=document.querySelector(e);null==t||t.scrollIntoView({behavior:"smooth",block:"start"})}},24144:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var l=a(96540),n=a(17317),r=a(813),o=a(29108),c=(e,t,a)=>new Promise((l,n)=>{var r=e=>{try{c(a.next(e))}catch(e){n(e)}},o=e=>{try{c(a.throw(e))}catch(e){n(e)}},c=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,o);c((a=a.apply(e,t)).next())});const s=()=>{const e="tool/vector-data-viewer|cache",[t,a]=(0,n.xI)({active:"vector-data",databaseName:"lanceDB",selectTableName:"",tableNames:[],dataSource:[]},e),s=()=>{const t=localStorage.getItem(e)||"{}";try{return JSON.parse(t)}catch(e){}return{}},i=(e="table")=>c(null,null,function*(){var l;if("table"===e&&t.selectTableName&&d(t.selectTableName),"tableNames"===e){const e=s(),t=yield(0,r.DQ)({url:"vector/tableNames"}),n=null==(l=null==t?void 0:t.data)?void 0:l.data;if(n){if(e.tableNames=n||[],e.selectTableName=(null==n?void 0:n[0])||"",e.selectTableName){const t=yield(0,r.DQ)({url:"/vector/table/get",params:{name:e.selectTableName}}),{data:a}=(null==t?void 0:t.data)||{};a&&(e.dataSource=null==a?void 0:a.map(e=>{const{id:t,text:a,key:l}=e;return{id:t,text:a,key:l}}))}a(e)}}}),d=e=>c(null,null,function*(){a({selectTableName:e});const t=yield(0,r.DQ)({url:"/vector/table/get",params:{name:e}}),{data:l}=(null==t?void 0:t.data)||{};if(l){const t=null==l?void 0:l.map(e=>{const{id:t,text:a,key:l}=e;return{id:t,text:a,key:l}});a({selectTableName:e,dataSource:t})}});return l.useEffect(()=>{"vector-data"===t.active&&c(null,null,function*(){var e;const t=s(),l=yield(0,r.DQ)({url:"vector/tableNames"}),n=null==(e=null==l?void 0:l.data)?void 0:e.data;n&&(t.tableNames=n||[],a(t))})},[t.active]),{state:t,setState:a,handleSelectTableName:d,handleClearTableData:()=>c(null,null,function*(){const e=yield(0,r.DQ)({method:"post",url:"/vector/clearTable",params:{tableName:t.selectTableName}});console.log(null==e?void 0:e.data),yield i("table")}),handleRefresh:i,handleDelTable:()=>c(null,null,function*(){const e=yield(0,r.DQ)({method:"post",url:"/vector/delTable",params:{tableName:t.selectTableName}});console.log(null==e?void 0:e.data),yield i("tableNames")}),handleDelTableData:e=>c(null,null,function*(){const a=yield(0,r.DQ)({method:"post",url:"/vector/delTableData",params:{tableName:t.selectTableName,data:(0,o.cy)(e)?e:[e]}});console.log(null==a?void 0:a.data),yield i("table")}),handleDelDuplicates:()=>c(null,null,function*(){})}};var i=a(21742);function d(e){var t,a;const{h:n}=e,{state:r,setState:o,handleSelectTableName:c}=n;return l.createElement("div",{className:"tool-vector-data-viewer__vector-data"},l.createElement("div",{className:"left-aside"},l.createElement("div",{className:"table-name-box"},null==(t=null==r?void 0:r.tableNames)?void 0:t.map(e=>l.createElement(i.i,{key:e,className:"table-name item",classNames:{select:e===r.selectTableName},onClick:()=>c(e)},e)))),l.createElement("div",{className:"content"},l.createElement(i.so,{style:{paddingBottom:10}},l.createElement(i.$n,{onClick:()=>n.handleRefresh("table")},"Refresh"),l.createElement(i.$n,{onClick:()=>n.handleClearTableData()},"Clear Table"),l.createElement(i.$n,{onClick:()=>n.handleDelTable()},"Del Table")),l.createElement("div",{className:"data-viewer"},l.createElement("div",{className:"header item no"},"No."),l.createElement("div",{className:"header item id"},"ID"),l.createElement("div",{className:"header item key"},"Key"),l.createElement("div",{className:"header item text"},"Text"),l.createElement("div",{className:"header"}),null==(a=null==r?void 0:r.dataSource)?void 0:a.map((e,t)=>{const{id:a,key:r,text:o}=e;return l.createElement(l.Fragment,{key:a},l.createElement("div",{className:"item no"},t+1),l.createElement("div",{className:"item id"},a),l.createElement("div",{className:"item key"},r),l.createElement("div",{className:"item text"},o),l.createElement(i.$n,{onClick:()=>n.handleDelTableData(e)},"Del"))}))))}var u=a(25823),m=Object.defineProperty,v=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,p=(e,t,a)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,y=(e,t,a)=>new Promise((l,n)=>{var r=e=>{try{c(a.next(e))}catch(e){n(e)}},o=e=>{try{c(a.throw(e))}catch(e){n(e)}},c=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,o);c((a=a.apply(e,t)).next())});const b=()=>{const e=l.useRef(null),[t,a]=(0,n.xI)({fileType:"",active:"1",name:"",fileContent:"",jsonContent:[],textChunks:[],vectors:[]},"dev/vector-data-viewer|processing-data|cache");return{own:t,setOwn:a,uploadBtnRef:e,handleSaveVectorDB:()=>y(null,null,function*(){var e;const a=yield(0,r.DQ)({method:"post",url:"/vector/save2VectorDB",params:{name:null!=(e=t.name)?e:"tmp",textChunks:"json"===t.fileType?t.jsonContent:t.textChunks||[]}}),{code:l}=(null==a?void 0:a.data)||{};console.log(null==a?void 0:a.data),200===l?i.iU.success("Save data to VectorDB Success"):i.iU.error("Save data to VectorDB Error")}),handleReadFile:e=>y(null,null,function*(){const t=e.name.split(".").at(-1),l=yield(0,u._)(e);if(console.log(l),"json"===t)try{const e=JSON.parse(l.trim())||[];a({fileType:t,active:"2",fileContent:l,jsonContent:e,textChunks:null==e?void 0:e.map(e=>e.text)})}catch(e){console.error(e),a({fileType:t,active:"1",fileContent:l,textChunks:[]})}else a({fileType:t,active:"1",fileContent:l})}),handleGenTextChunk:()=>y(null,null,function*(){var e;const l=yield(0,r.DQ)({method:"post",url:"/vector/genTextChunks",params:{value:t.fileContent}}),n=(null==(e=null==l?void 0:l.data)?void 0:e.data)||[];console.log(n),a({active:"2",textChunks:n})}),handleGenTextChunkVector:()=>y(null,null,function*(){var e,l;const n=yield(0,r.DQ)({method:"post",url:"/vector/genTextChunkVectors",params:{name:null!=(e=t.name)?e:"tmp",list:"json"===t.fileType?t.jsonContent:t.textChunks}}),o=(null==(l=null==n?void 0:n.data)?void 0:l.data)||[];console.log(o),a({active:"3",vectors:o.map(e=>{const t=e,{vector:a}=t;return((e,t)=>{for(var a in t||(t={}))h.call(t,a)&&p(e,a,t[a]);if(v)for(var a of v(t))f.call(t,a)&&p(e,a,t[a]);return e})({},((e,t)=>{var a={};for(var l in e)h.call(e,l)&&t.indexOf(l)<0&&(a[l]=e[l]);if(null!=e&&v)for(var l of v(e))t.indexOf(l)<0&&f.call(e,l)&&(a[l]=e[l]);return a})(t,["vector"]))})||[]})}),handleClear:()=>{a({active:"1",name:"",fileContent:"",textChunks:[],vectors:[]})}}};function C(e){var t,a;const{own:n,setOwn:r,uploadBtnRef:c,handleSaveVectorDB:s,handleReadFile:d,handleGenTextChunk:u,handleGenTextChunkVector:m,handleClear:v}=b();return l.createElement("div",{className:"tool-vector-data-viewer__processing-data"},l.createElement("div",{className:"left-aside"},l.createElement("input",{ref:c,type:"file",style:{display:"none"},onChange:e=>{var t;const a=null==(t=e.target.files)?void 0:t[0];d(a)}}),l.createElement(i.pd,{value:n.name,onChange:e=>{r({name:e.target.value||""})}}),l.createElement(i.$n,{onClick:()=>{var e;return null==(e=c.current)?void 0:e.click()}},"Upload File"),l.createElement(i.$n,{disabled:!n.fileContent,onClick:()=>u()},"Text Chunk"),l.createElement(i.$n,{disabled:!(0,o.vH)(n.textChunks),onClick:()=>m()},"Vectorization"),l.createElement(i.$n,{onClick:()=>s()},"Save Vector DB"),l.createElement(i.$n,{onClick:()=>v()},"Clear")),l.createElement("div",{className:"right-aside"},l.createElement(i.oz,{value:n.active,onChange:e=>r({active:e}),items:[{key:"1",title:"File Content",children:l.createElement("pre",null,n.fileContent)},{key:"2",title:"Chunks Data",children:l.createElement("div",{className:"chunks-data"},null==(t=null==n?void 0:n.textChunks)?void 0:t.map((e,t)=>l.createElement("div",{key:t,className:"row"},e)))},{key:"3",title:"Vector Data",children:l.createElement("div",{className:"vectors-data"},l.createElement("div",{className:"item header id"},"ID"),l.createElement("div",{className:"item header key"},"Key"),l.createElement("div",{className:"item header text"},"Text"),null==(a=null==n?void 0:n.vectors)?void 0:a.map((e,t)=>{const{id:a,key:n,text:r}=e;return l.createElement(l.Fragment,{key:t},l.createElement("div",{className:"item id"},a),l.createElement("div",{className:"item key"},n),l.createElement("div",{className:"item text"},r))}))}]})))}function N(){const e=s(),{state:t,setState:a}=e,n=[{key:"vector-data",title:"Vector Data",children:l.createElement(d,{h:e})},{key:"processing-data",title:"Processing Data",children:l.createElement(C,{h:e})}];return l.createElement("div",{className:"tool-vector-data-viewer"},l.createElement(i.oz,{value:t.active,items:n,onChange:e=>a({active:e})}))}},25823:(e,t,a)=>{a.d(t,{_:()=>o});var l=a(29108),n=a(70306),r=(e,t,a)=>new Promise((l,n)=>{var r=e=>{try{c(a.next(e))}catch(e){n(e)}},o=e=>{try{c(a.throw(e))}catch(e){n(e)}},c=e=>e.done?l(e.value):Promise.resolve(e.value).then(r,o);c((a=a.apply(e,t)).next())});const o=e=>r(null,null,function*(){return new Promise(t=>r(null,null,function*(){if(!(0,l.Kg)(e.name))return;const a=e.name.split(".").at(-1),o=new FileReader;if(o.onerror=function(){t("")},["md","txt","json"].includes(a))return o.onload=function(e){var a;const n=(null==(a=e.target)?void 0:a.result)||"";(0,l.Kg)(n)&&t(n)},void o.readAsText(e);if(["docx"].includes(a))return o.onload=function(e){var a;const l=(null==(a=e.target)?void 0:a.result)||"";n.extractRawText({arrayBuffer:l}).then(e=>{console.log(e),t((null==e?void 0:e.value)||"")}).catch(()=>{t("")})},void o.readAsArrayBuffer(e);if(["pdf"].includes(a)){const a=(e,t)=>r(null,null,function*(){const a=yield e.getPage(t),l=yield a.getTextContent(),n=[];let r="",o=-1;l.items.map(e=>{const{str:t,hasEOL:a}=e;return a?(r.length>o&&(o=r.length),n.push(r),r=""):r+=t,t});let c="",s=3*o/5;return n.forEach((e,t)=>{e.length<s?c=c+e+"\n":c+=e}),c});return o.onload=e=>r(null,null,function*(){var l;try{const n=(null==(l=e.target)?void 0:l.result)||"",r=yield window.pdfjsLib.getDocument(n).promise,o=[];console.log(r);for(let e=1;e<=r.numPages;e++)o.push(a(r,e));const c=yield Promise.all(o);console.log(c),t(c.join("\n"))}catch(e){console.error(e),t("")}}),void o.readAsArrayBuffer(e)}t("")}))})}}]);