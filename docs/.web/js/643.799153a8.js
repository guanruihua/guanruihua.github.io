"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[643],{643:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var r=n(96540),o=n(17317);const c=()=>{const[e,t]=(0,o.xI)({selectFileType:"",review:""},"dev/file-review|cache");return{state:e,setState:t}};var l=n(45134),u=(e,t,n)=>new Promise((r,o)=>{var c=e=>{try{u(n.next(e))}catch(e){o(e)}},l=e=>{try{u(n.throw(e))}catch(e){o(e)}},u=e=>e.done?r(e.value):Promise.resolve(e.value).then(c,l);u((n=n.apply(e,t)).next())});function i(){const{state:e,setState:t}=c();return r.useEffect(()=>{const e=document.createElement("script");return e.src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js",e.onload=()=>{window.pdfjsLib.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js",console.log("PDF.js 已加载")},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]),r.createElement("div",{className:"tool-file-review"},r.createElement("div",{className:"content"},r.createElement("div",{className:"controls"},r.createElement("h5",null,"md, txt, docx, pdf"),r.createElement("input",{type:"file",onChange:e=>{var n;(e=>{u(null,null,function*(){const n=yield(0,l._)(e);console.log(n),t({review:n})})})(null==(n=e.target.files)?void 0:n[0])}})),r.createElement("div",{className:"review"},r.createElement("pre",null,e.review))))}},17317:(e,t,n)=>{n.d(t,{xI:()=>s});var r=n(96540);function o(e){return null==e||e!=e}function c(e){try{if("object"==typeof(t=e)&&!o(t)&&/Iterator\]$/.test(t.toString()))return"Iterator";const n=Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1];return"Number"===n&&isNaN(e)?"NaN":n}catch(e){return"Undefined"}var t}function l(e){return"string"==typeof e}const u=e=>"number"==typeof e&&"Number"===c(e);function i(e){return!o(e)&&(function(e){return Array.isArray(e)}(e)&&e.length>0)}const a="undefined"!=typeof window;function s(e={},t,n=localStorage){const[o,c]=(0,r.useState)(e),a=e=>{if(c(e),t)try{n.setItem(t,JSON.stringify(e))}catch(e){return void console.warn(e)}};return(0,r.useEffect)(()=>{if(t)try{const e=n.getItem(t);if(!e||"{}"===e)return;a(JSON.parse(e))}catch(e){return}},[t,n]),[o,(e,t=!1)=>{const n="function"==typeof e?e(o):e;a(t?n:{...o,...n})},t=>{if(i(t)){const n={...o};return t.forEach(t=>{(l(t)||u(t))&&(n[t]=e[t])}),void a(n)}a(e)}]}a&&window?.navigator?.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent)},29108:(e,t,n)=>{function r(e){return null==e||e!=e}function o(e){return void 0===e}n.d(t,{B9:()=>u,Et:()=>a,Gv:()=>l,Im:()=>r,Kg:()=>i,Lm:()=>p,ZX:()=>s,b0:()=>o,cy:()=>d,vH:()=>f});Number.isNaN;function c(e){try{if("object"==typeof(t=e)&&!r(t)&&/Iterator\]$/.test(t.toString()))return"Iterator";const n=Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1];return"Number"===n&&isNaN(e)?"NaN":n}catch(e){return"Undefined"}var t}function l(e){return null!==e&&"object"==typeof e&&"Object"===c(e)}function u(e){return!r(e)&&(l(e)&&0!==Reflect.ownKeys(e).length)}function i(e){return"string"==typeof e}const a=e=>"number"==typeof e&&"Number"===c(e);function s(e){return!!a(e)||(i(e)&&(e=e.trim()),!r(e)&&""!==e&&!1===Number.isNaN(Number(e)))}function d(e){return Array.isArray(e)}function f(e){return!r(e)&&(d(e)&&e.length>0)}new Map([["Image",["png","jpeg","jpg","png","bmp"]],["Video",["mp4","webm","ogg"]],["PDF",["pdf"]],["Word",["doc","docx"]],["Excel",[".xlsx",".xls",".csv"]]]);const m="undefined"!=typeof window,p=e=>"boolean"==typeof e;m&&window?.navigator?.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent)},45134:(e,t,n)=>{n.d(t,{_:()=>l});var r=n(29108),o=n(70306),c=(e,t,n)=>new Promise((r,o)=>{var c=e=>{try{u(n.next(e))}catch(e){o(e)}},l=e=>{try{u(n.throw(e))}catch(e){o(e)}},u=e=>e.done?r(e.value):Promise.resolve(e.value).then(c,l);u((n=n.apply(e,t)).next())});const l=e=>c(null,null,function*(){return new Promise(t=>c(null,null,function*(){if(!(0,r.Kg)(e.name))return;const n=e.name.split(".").at(-1),l=new FileReader;if(l.onerror=function(){t("")},["md","txt","json"].includes(n))return l.onload=function(e){var n;const o=(null==(n=e.target)?void 0:n.result)||"";(0,r.Kg)(o)&&t(o)},void l.readAsText(e);if(["docx"].includes(n))return l.onload=function(e){var n;const r=(null==(n=e.target)?void 0:n.result)||"";o.extractRawText({arrayBuffer:r}).then(e=>{console.log(e),t((null==e?void 0:e.value)||"")}).catch(()=>{t("")})},void l.readAsArrayBuffer(e);if(["pdf"].includes(n)){const n=(e,t)=>c(null,null,function*(){const n=yield e.getPage(t),r=yield n.getTextContent(),o=[];let c="",l=-1;r.items.map(e=>{const{str:t,hasEOL:n}=e;return n?(c.length>l&&(l=c.length),o.push(c),c=""):c+=t,t});let u="",i=3*l/5;return o.forEach((e,t)=>{e.length<i?u=u+e+"\n":u+=e}),u});return l.onload=e=>c(null,null,function*(){var r;try{const o=(null==(r=e.target)?void 0:r.result)||"",c=yield window.pdfjsLib.getDocument(o).promise,l=[];console.log(c);for(let e=1;e<=c.numPages;e++)l.push(n(c,e));const u=yield Promise.all(l);console.log(u),t(u.join("\n"))}catch(e){console.error(e),t("")}}),void l.readAsArrayBuffer(e)}t("")}))})}}]);