"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[4223],{2049:(e,t,n)=>{n.d(t,{_:()=>a});var l=n(1814),r=n(2881),o=(e,t,n)=>new Promise((l,r)=>{var o=e=>{try{s(n.next(e))}catch(e){r(e)}},a=e=>{try{s(n.throw(e))}catch(e){r(e)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,a);s((n=n.apply(e,t)).next())});const a=e=>o(null,null,function*(){return new Promise(t=>o(null,null,function*(){if(!(0,l.Kg)(e.name))return;const n=e.name.split(".").at(-1),a=new FileReader;if(a.onerror=function(){t("")},["md","txt","json"].includes(n))return a.onload=function(e){var n;const r=(null==(n=e.target)?void 0:n.result)||"";(0,l.Kg)(r)&&t(r)},void a.readAsText(e);if(["docx"].includes(n))return a.onload=function(e){var n;const l=(null==(n=e.target)?void 0:n.result)||"";r.extractRawText({arrayBuffer:l}).then(e=>{console.log(e),t((null==e?void 0:e.value)||"")}).catch(()=>{t("")})},void a.readAsArrayBuffer(e);if(["pdf"].includes(n)){const n=(e,t)=>o(null,null,function*(){const n=yield e.getPage(t),l=yield n.getTextContent(),r=[];let o="",a=-1;l.items.map(e=>{const{str:t,hasEOL:n}=e;return n?(o.length>a&&(a=o.length),r.push(o),o=""):o+=t,t});let s="",c=3*a/5;return r.forEach((e,t)=>{e.length<c?s=s+e+"\n":s+=e}),s});return a.onload=e=>o(null,null,function*(){var l;try{const r=(null==(l=e.target)?void 0:l.result)||"",o=yield window.pdfjsLib.getDocument(r).promise,a=[];console.log(o);for(let e=1;e<=o.numPages;e++)a.push(n(o,e));const s=yield Promise.all(a);console.log(s),t(s.join("\n"))}catch(e){console.error(e),t("")}}),void a.readAsArrayBuffer(e)}t("")}))})},4223:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var l=n(5296),r=n(6045);const o=()=>{const[e,t]=(0,r.xI)({selectFileType:"",review:""},"dev/file-review|cache");return{state:e,setState:t}};var a=n(2049),s=(e,t,n)=>new Promise((l,r)=>{var o=e=>{try{s(n.next(e))}catch(e){r(e)}},a=e=>{try{s(n.throw(e))}catch(e){r(e)}},s=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,a);s((n=n.apply(e,t)).next())});function c(){const{state:e,setState:t}=o();return l.useEffect(()=>{const e=document.createElement("script");return e.src="/js/pdf.2.12.313.min.js",e.onload=()=>{window.pdfjsLib.GlobalWorkerOptions.workerSrc="/js/pdf.2.12.313.worker.min.js",console.log("PDF.js 已加载")},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]),l.createElement("div",{className:"tool-file-review"},l.createElement("div",{className:"content"},l.createElement("div",{className:"controls"},l.createElement("h5",null,"md, txt, docx, pdf"),l.createElement("input",{type:"file",onChange:e=>{var n;(e=>{s(null,null,function*(){const n=yield(0,a._)(e);console.log(n),t({review:n})})})(null==(n=e.target.files)?void 0:n[0])}})),l.createElement("div",{className:"review"},l.createElement("pre",null,e.review))))}}}]);