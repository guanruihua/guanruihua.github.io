"use strict";(self.webpackChunkguanruihua_github_io=self.webpackChunkguanruihua_github_io||[]).push([[1458],{11814:(e,t,n)=>{function r(e){return null==e||e!=e}function o(e){return void 0===e}n.d(t,{B9:()=>i,Et:()=>a,Gv:()=>u,Im:()=>r,Kg:()=>l,Lm:()=>g,ZX:()=>s,b0:()=>o,cy:()=>d,vH:()=>f});Number.isNaN;function c(e){try{if("object"==typeof(t=e)&&!r(t)&&/Iterator\]$/.test(t.toString()))return"Iterator";const n=Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1];return"Number"===n&&isNaN(e)?"NaN":n}catch(e){return"Undefined"}var t}function u(e){return null!==e&&"object"==typeof e&&"Object"===c(e)}function i(e){return!r(e)&&(u(e)&&0!==Reflect.ownKeys(e).length)}function l(e){return"string"==typeof e}const a=e=>"number"==typeof e&&"Number"===c(e);function s(e){return!!a(e)||(l(e)&&(e=e.trim()),!r(e)&&""!==e&&!1===Number.isNaN(Number(e)))}function d(e){return Array.isArray(e)}function f(e){return!r(e)&&(d(e)&&e.length>0)}new Map([["Image",["png","jpeg","jpg","png","bmp"]],["Video",["mp4","webm","ogg"]],["PDF",["pdf"]],["Word",["doc","docx"]],["Excel",[".xlsx",".xls",".csv"]]]);const m="undefined"!=typeof window,g=e=>"boolean"==typeof e;m&&window?.navigator?.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent)},41458:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});var r=n(65296),o=n(46045);const c=()=>{const[e,t]=(0,o.xI)({selectFileType:"",review:""},"dev/file-review|cache");return{state:e,setState:t}};var u=n(70333),i=(e,t,n)=>new Promise((r,o)=>{var c=e=>{try{i(n.next(e))}catch(e){o(e)}},u=e=>{try{i(n.throw(e))}catch(e){o(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(c,u);i((n=n.apply(e,t)).next())});function l(){const{state:e,setState:t}=c();return r.useEffect(()=>{const e=document.createElement("script");return e.src="/js/pdf/2.12.313/pdf.min.js",e.onload=()=>{window.pdfjsLib.GlobalWorkerOptions.workerSrc="/js/pdf/2.12.313/pdf.worker.min.js",console.log("PDF.js 已加载")},document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]),r.createElement("div",{className:"tool-file-review"},r.createElement("div",{className:"content"},r.createElement("div",{className:"controls"},r.createElement("h5",null,"md, txt, docx, pdf"),r.createElement("input",{type:"file",onChange:e=>{var n;(e=>{i(null,null,function*(){const n=yield(0,u._)(e);console.log(n),t({review:n})})})(null==(n=e.target.files)?void 0:n[0])}})),r.createElement("div",{className:"review"},r.createElement("pre",null,e.review))))}},46045:(e,t,n)=>{n.d(t,{xI:()=>s});var r=n(65296);function o(e){return null==e||e!=e}function c(e){try{if("object"==typeof(t=e)&&!o(t)&&/Iterator\]$/.test(t.toString()))return"Iterator";const n=Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1];return"Number"===n&&isNaN(e)?"NaN":n}catch(e){return"Undefined"}var t}function u(e){return"string"==typeof e}const i=e=>"number"==typeof e&&"Number"===c(e);function l(e){return!o(e)&&(function(e){return Array.isArray(e)}(e)&&e.length>0)}const a="undefined"!=typeof window;function s(e={},t,n=localStorage){const[o,c]=(0,r.useState)(e),a=e=>{if(c(e),t)try{n.setItem(t,JSON.stringify(e))}catch(e){return void console.warn(e)}};return(0,r.useEffect)(()=>{if(t)try{const e=n.getItem(t);if(!e||"{}"===e)return;a(JSON.parse(e))}catch(e){return}},[t,n]),[o,(e,t=!1)=>{const n="function"==typeof e?e(o):e;a(t?n:{...o,...n})},t=>{if(l(t)){const n={...o};return t.forEach(t=>{(u(t)||i(t))&&(n[t]=e[t])}),void a(n)}a(e)}]}a&&window?.navigator?.userAgent&&/iP(ad|hone|od)/.test(window.navigator.userAgent)},70333:(e,t,n)=>{n.d(t,{_:()=>u});var r=n(11814),o=n(80696),c=(e,t,n)=>new Promise((r,o)=>{var c=e=>{try{i(n.next(e))}catch(e){o(e)}},u=e=>{try{i(n.throw(e))}catch(e){o(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(c,u);i((n=n.apply(e,t)).next())});const u=e=>c(null,null,function*(){return new Promise(t=>c(null,null,function*(){if(!(0,r.Kg)(e.name))return;const n=e.name.split(".").at(-1),u=new FileReader;if(u.onerror=function(){t("")},["md","txt","json"].includes(n))return u.onload=function(e){var n;const o=(null==(n=e.target)?void 0:n.result)||"";(0,r.Kg)(o)&&t(o)},void u.readAsText(e);if(["docx"].includes(n))return u.onload=function(e){var n;const r=(null==(n=e.target)?void 0:n.result)||"";o.extractRawText({arrayBuffer:r}).then(e=>{console.log(e),t((null==e?void 0:e.value)||"")}).catch(()=>{t("")})},void u.readAsArrayBuffer(e);if(["pdf"].includes(n)){const n=(e,t)=>c(null,null,function*(){const n=yield e.getPage(t),r=yield n.getTextContent(),o=[];let c="",u=-1;r.items.map(e=>{const{str:t,hasEOL:n}=e;return n?(c.length>u&&(u=c.length),o.push(c),c=""):c+=t,t});let i="",l=3*u/5;return o.forEach((e,t)=>{e.length<l?i=i+e+"\n":i+=e}),i});return u.onload=e=>c(null,null,function*(){var r;try{const o=(null==(r=e.target)?void 0:r.result)||"",c=yield window.pdfjsLib.getDocument(o).promise,u=[];console.log(c);for(let e=1;e<=c.numPages;e++)u.push(n(c,e));const i=yield Promise.all(u);console.log(i),t(i.join("\n"))}catch(e){console.error(e),t("")}}),void u.readAsArrayBuffer(e)}t("")}))})}}]);