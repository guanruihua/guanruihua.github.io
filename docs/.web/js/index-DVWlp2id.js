import{j as r,F as g,g as j}from"./index-BFOesgsR.js";import{u as w}from"./index.esm-CmTEOao8.js";import{c as d,i as h,l as x,b as y}from"./index.esm-Bg5LkWwD.js";const N=["C","Del","%","÷","7","8","9","x","4","5","6","-","1","2","3","+","Switch","0",".","="],u=t=>h(t)&&t?x(t.at(0))&&x(t.at(-1)):!1,v=t=>{let i;const n=t.split(/(\d)/gi).filter(Boolean);let e="*";return n.forEach((s,l)=>{if(["*","/","**"].includes(s)){e=s;return}const a=parseFloat(s);if(d(a)){if(!d(i)){i=a;return}e==="**"&&(i**=a),e==="*"&&(i*=a),e==="/"&&(i/=a),e="*";return}}),String(i||0)},S=t=>{let i=0;const n=t.split(/(\+|\-)/gi);let e="+";return n.forEach((s,l)=>{if(["+","-"].includes(s)){e=s;return}const a=parseFloat(s);if(d(a)){e==="-"&&(i-=a),e==="+"&&(i+=a),e="+";return}}),String(i)},m=t=>(/\/|÷|\*|x/.test(t)&&t.split(/\+|-/gi).forEach(n=>{if(u(n)&&h(t)&&/\*|x|\/|÷/.test(n)){const e=v(n);t=t.replaceAll(n,e)}}),/\+|-/.test(t)?S(t):t);function p(t,i){return((t.match(i)||[]).length||0)>0}const k=t=>{if(!t)return"0";if(d(t)&&(t=String(t)),h(t))t.indexOf("x")>0&&(t=t.replaceAll("x","*")),t.indexOf("÷")>0&&(t=t.replaceAll("÷","/")),t=t.trim();else return"0";if(d(Number(t)))return t;let i=0;const n=s=>{if(i++>3e3)return"0";let l=s.split(/(\[|\]|\(|\))/).filter(Boolean);const a=o=>{(l[o-1]==="("&&l[o+1]===")"||l[o-1]==="["&&l[o+1]==="]")&&(l[o-1]="",l[o+1]="")};l.forEach((o,f)=>{u(o)&&p(o,/\+|-|\*|\\/g)&&(l[f]=m(o),a(f))});let c=l.join("");return(c.indexOf("(")>-1&&c.indexOf(")")>-1||c.indexOf("[")>-1&&c.indexOf("]")>-1)&&(c=n(c)),u(c)&&p(c,/\+|-|\*|\\/g)?m(c):c};return n(t)};function B(){const[t,i]=w({formula:"",result:"",history:[],type:"default",inputFormulaInput:"",inputFormulaResult:"",inputFormulas:[]},"/tool/calculator/cache"),n=e=>{let s="";switch(e){case"C":s="";break;case"Del":s=(t?.formula||"").replace(/.$/,"");break;case"=":break;case"Switch":return;default:s=(t?.formula||"")+e;break}const l={formula:s,result:k(s)};if(e==="="&&t.formula){const a=`${t.formula}=${t.result}`;y(t.history)?t.history.unshift(a):t.history=[a],l.history=t.history.slice(0,100)}i(l)};return r.jsxs("div",{className:"tool-calculator",children:[r.jsx(g,{style:{zoom:".8",marginBottom:10}}),r.jsxs(j,{className:"tool-calculator-layout",children:[r.jsx("div",{className:"simple",children:N.map(e=>{const s=()=>n(e);return e==="Switch"?r.jsx("div",{className:"keypad","data-val":e,onClick:s,children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24",children:r.jsx("path",{fill:"currentColor",d:"M14.293 2.293a1 1 0 0 1 1.414 0l4 4a1 1 0 0 1 0 1.414l-4 4a1 1 0 0 1-1.414-1.414L16.586 8H5a1 1 0 0 1 0-2h11.586l-2.293-2.293a1 1 0 0 1 0-1.414m-4.586 10a1 1 0 0 1 0 1.414L7.414 16H19a1 1 0 1 1 0 2H7.414l2.293 2.293a1 1 0 0 1-1.414 1.414l-4-4a1 1 0 0 1 0-1.414l4-4a1 1 0 0 1 1.414 0"})})},e):e==="-"?r.jsx("div",{className:"keypad","data-val":e,onClick:s,children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"0.88em",height:"1em",viewBox:"0 0 448 512",children:r.jsx("path",{fill:"currentColor",d:"M432 256c0 17.7-14.3 32-32 32H48c-17.7 0-32-14.3-32-32s14.3-32 32-32h352c17.7 0 32 14.3 32 32"})})},e):r.jsx("div",{className:"keypad","data-val":e,onClick:s,children:e},e)})}),r.jsxs("div",{className:"history-box",children:[r.jsxs("div",{className:"now",children:[r.jsx("div",{className:"result",children:t?.result}),r.jsx("div",{className:"formula",children:t?.formula})]}),r.jsx("div",{className:"history",children:t?.history?.map((e,s)=>r.jsx("div",{className:"item",children:e},s))})]})]})]})}export{B as default};
